var _0x29d80a=_0x5bff;(function(_0x134695,_0x1d537e){var _0x1bff2e=_0x5bff,_0x3e89f6=_0x134695();while(!![]){try{var _0x290148=-parseInt(_0x1bff2e(0x343))/0x1+parseInt(_0x1bff2e(0x26c))/0x2*(-parseInt(_0x1bff2e(0x299))/0x3)+-parseInt(_0x1bff2e(0x269))/0x4*(parseInt(_0x1bff2e(0x31d))/0x5)+parseInt(_0x1bff2e(0x271))/0x6*(parseInt(_0x1bff2e(0x203))/0x7)+-parseInt(_0x1bff2e(0x34f))/0x8+parseInt(_0x1bff2e(0x2e4))/0x9+parseInt(_0x1bff2e(0x222))/0xa;if(_0x290148===_0x1d537e)break;else _0x3e89f6['push'](_0x3e89f6['shift']());}catch(_0x442a0a){_0x3e89f6['push'](_0x3e89f6['shift']());}}}(_0x115e,0xb9830));const express=require(_0x29d80a(0x306)),app=express();var os=require('os'),ip=require('ip'),fs=require('fs');const http=require(_0x29d80a(0x328)),https=require(_0x29d80a(0x272));var config=require(_0x29d80a(0x28e)),server=http['createServer'](app);if(config['sslCertificatePath']['isSsl']){var options={'key':fs['readFileSync'](config['sslCertificatePath'][_0x29d80a(0x236)]),'cert':fs['readFileSync'](config[_0x29d80a(0x29d)]['cert'])};server=https[_0x29d80a(0x33f)](options,app);}const {Server}=require(_0x29d80a(0x2ba)),io=new Server(server),mysql=require(_0x29d80a(0x27f)),admin=require(_0x29d80a(0x332)),crypto=require(_0x29d80a(0x30f)),{RtcTokenBuilder,RtmTokenBuilder,RtcRole,RtmRole}=require('agora-access-token');var apn=require(_0x29d80a(0x32f));const {v4:uuidv4}=require(_0x29d80a(0x206)),STATUS_UNRECEIVED=0x1,STATUS_RECEIVED=0x2,STATUS_READ=0x3,STATUS_DELETED=0x0,CURRENT_STATUS_SEND=0x1,CURRENT_STATUS_DELIVERED=0x2,CURRENT_STATUS_SEEN=0x3,CHAT_ROOM_USER_STATUS_ACTIVE=0xa,CHAT_ROOM_USER_STATUS_REMOVED=0x2,CHAT_ROOM_USER_STATUS_LEFT=0x3,CHAT_ROOM_TYPE_PRIVATE=0x1,CHAT_ROOM_TYPE_GROUP=0x2,CHAT_ROOM_TYPE_OPEN=0x3,COMMON_NO=0x0,COMMON_YES=0x1,STATUS_LIVE_CALL_ONGOING=0x1,STATUS_LIVE_CALL_COMPLETED=0x2,STATUS_LIVE_CALL_BATTLE_PENDING=0x1,STATUS_LIVE_CALL_BATTLE_ACCEPTED=0x2,STATUS_LIVE_CALL_BATTLE_REJECTED=0x3,STATUS_LIVE_CALL_BATTLE_ONGOING=0x4,STATUS_LIVE_CALL_BATTLE_CANCELLED=0x5,STATUS_LIVE_CALL_BATTLE_COMPLETED=0xa,STORAGE_URL=config[_0x29d80a(0x31e)];let db;var hostname=os[_0x29d80a(0x2ec)]();console[_0x29d80a(0x2a1)](hostname);var serviceAccount;hostname=='DESKTOP-MRLV3Q3'?db=mysql[_0x29d80a(0x2e5)]({'host':config['db']['dev'][_0x29d80a(0x211)],'user':config['db']['dev'][_0x29d80a(0x2db)],'password':config['db']['dev'][_0x29d80a(0x27b)],'database':config['db'][_0x29d80a(0x34a)]['database']}):db=mysql[_0x29d80a(0x2e5)]({'host':config['db'][_0x29d80a(0x26a)][_0x29d80a(0x211)],'user':config['db'][_0x29d80a(0x26a)][_0x29d80a(0x2db)],'password':config['db'][_0x29d80a(0x26a)][_0x29d80a(0x27b)],'database':config['db'][_0x29d80a(0x26a)]['database']});serviceAccount=require(_0x29d80a(0x2b5)),admin[_0x29d80a(0x2b4)]({'credential':admin[_0x29d80a(0x24f)][_0x29d80a(0x316)](serviceAccount),'databaseURL':config['pushNotification'][_0x29d80a(0x302)]}),process['on'](_0x29d80a(0x20d),_0x38fe7d=>console[_0x29d80a(0x1f0)](_0x38fe7d[_0x29d80a(0x253)])),db['connect'](function(_0x3d4344){var _0x5334f6=_0x29d80a;if(_0x3d4344)console[_0x5334f6(0x2a1)](_0x3d4344);console['log'](_0x5334f6(0x20f));let _0x4856cf=_0x5334f6(0x2de);db[_0x5334f6(0x250)](_0x4856cf,function(_0x4af24f,_0x109720,_0x25b2f6){var _0x3d59e4=_0x5334f6;if(_0x4af24f)throw _0x4af24f;var _0x2db0e4=_0x109720[0x0][_0x3d59e4(0x340)],_0x34b35c=_0x109720[0x0][_0x3d59e4(0x224)],_0x428291=ip['address'](),_0x514af='?purchase_code='+_0x2db0e4+_0x3d59e4(0x248)+_0x34b35c+'&source_type=chat&ip='+_0x428291,_0x52f575='aHR0cHM6Ly9md2R0ZWNobm9sb2d5LmNvL2xpY2VuY2VfY2hlY2tlci9hcGkvd2ViL3YxL2xpY2VuY2Vz',_0x6867af={'_keyStr':_0x3d59e4(0x2c4),'encode':function(_0xafc4b2){var _0x1387fd=_0x3d59e4,_0x273f76='',_0x1f19f1,_0x40ea5c,_0x26a301,_0xed1aec,_0xba1f42,_0x2baab6,_0x307eaf,_0x1ba44b=0x0;_0xafc4b2=_0x6867af[_0x1387fd(0x205)](_0xafc4b2);while(_0x1ba44b<_0xafc4b2['length']){_0x1f19f1=_0xafc4b2[_0x1387fd(0x1f3)](_0x1ba44b++),_0x40ea5c=_0xafc4b2['charCodeAt'](_0x1ba44b++),_0x26a301=_0xafc4b2[_0x1387fd(0x1f3)](_0x1ba44b++),_0xed1aec=_0x1f19f1>>0x2,_0xba1f42=(_0x1f19f1&0x3)<<0x4|_0x40ea5c>>0x4,_0x2baab6=(_0x40ea5c&0xf)<<0x2|_0x26a301>>0x6,_0x307eaf=_0x26a301&0x3f;if(isNaN(_0x40ea5c))_0x2baab6=_0x307eaf=0x40;else isNaN(_0x26a301)&&(_0x307eaf=0x40);_0x273f76=_0x273f76+this[_0x1387fd(0x2ad)]['charAt'](_0xed1aec)+this['_keyStr']['charAt'](_0xba1f42)+this[_0x1387fd(0x2ad)][_0x1387fd(0x246)](_0x2baab6)+this['_keyStr'][_0x1387fd(0x246)](_0x307eaf);}return _0x273f76;},'decode':function(_0x54946a){var _0x1cf8fa=_0x3d59e4,_0x2b14bf='',_0x4e981c,_0x1ef27d,_0x589fe3,_0x5efa59,_0x3055b1,_0x4332c5,_0x1723d8,_0x4d62f0=0x0;_0x54946a=_0x54946a[_0x1cf8fa(0x1ff)](/[^A-Za-z0-9+/=]/g,'');while(_0x4d62f0<_0x54946a[_0x1cf8fa(0x342)]){_0x5efa59=this[_0x1cf8fa(0x2ad)][_0x1cf8fa(0x289)](_0x54946a[_0x1cf8fa(0x246)](_0x4d62f0++)),_0x3055b1=this[_0x1cf8fa(0x2ad)][_0x1cf8fa(0x289)](_0x54946a[_0x1cf8fa(0x246)](_0x4d62f0++)),_0x4332c5=this['_keyStr'][_0x1cf8fa(0x289)](_0x54946a['charAt'](_0x4d62f0++)),_0x1723d8=this[_0x1cf8fa(0x2ad)]['indexOf'](_0x54946a[_0x1cf8fa(0x246)](_0x4d62f0++)),_0x4e981c=_0x5efa59<<0x2|_0x3055b1>>0x4,_0x1ef27d=(_0x3055b1&0xf)<<0x4|_0x4332c5>>0x2,_0x589fe3=(_0x4332c5&0x3)<<0x6|_0x1723d8,_0x2b14bf=_0x2b14bf+String[_0x1cf8fa(0x31f)](_0x4e981c),_0x4332c5!=0x40&&(_0x2b14bf=_0x2b14bf+String['fromCharCode'](_0x1ef27d)),_0x1723d8!=0x40&&(_0x2b14bf=_0x2b14bf+String[_0x1cf8fa(0x31f)](_0x589fe3));}return _0x2b14bf=_0x6867af['_utf8_decode'](_0x2b14bf),_0x2b14bf;},'_utf8_encode':function(_0x1b8dde){var _0x3a71a4=_0x3d59e4;_0x1b8dde=_0x1b8dde[_0x3a71a4(0x1ff)](/rn/g,'n');var _0x59fb44='';for(var _0x445bff=0x0;_0x445bff<_0x1b8dde[_0x3a71a4(0x342)];_0x445bff++){var _0x434b65=_0x1b8dde[_0x3a71a4(0x1f3)](_0x445bff);if(_0x434b65<0x80)_0x59fb44+=String[_0x3a71a4(0x31f)](_0x434b65);else _0x434b65>0x7f&&_0x434b65<0x800?(_0x59fb44+=String[_0x3a71a4(0x31f)](_0x434b65>>0x6|0xc0),_0x59fb44+=String[_0x3a71a4(0x31f)](_0x434b65&0x3f|0x80)):(_0x59fb44+=String['fromCharCode'](_0x434b65>>0xc|0xe0),_0x59fb44+=String['fromCharCode'](_0x434b65>>0x6&0x3f|0x80),_0x59fb44+=String[_0x3a71a4(0x31f)](_0x434b65&0x3f|0x80));}return _0x59fb44;},'_utf8_decode':function(_0xf6a07){var _0xf863a0=_0x3d59e4,_0x42a63d='',_0x4acf7a=0x0,_0x110445=c1=c2=0x0;while(_0x4acf7a<_0xf6a07['length']){_0x110445=_0xf6a07['charCodeAt'](_0x4acf7a);if(_0x110445<0x80)_0x42a63d+=String[_0xf863a0(0x31f)](_0x110445),_0x4acf7a++;else _0x110445>0xbf&&_0x110445<0xe0?(c2=_0xf6a07['charCodeAt'](_0x4acf7a+0x1),_0x42a63d+=String[_0xf863a0(0x31f)]((_0x110445&0x1f)<<0x6|c2&0x3f),_0x4acf7a+=0x2):(c2=_0xf6a07['charCodeAt'](_0x4acf7a+0x1),c3=_0xf6a07[_0xf863a0(0x1f3)](_0x4acf7a+0x2),_0x42a63d+=String['fromCharCode']((_0x110445&0xf)<<0xc|(c2&0x3f)<<0x6|c3&0x3f),_0x4acf7a+=0x3);}return _0x42a63d;}},_0x52f575=_0x6867af[_0x3d59e4(0x24b)](_0x52f575);_0x52f575=_0x52f575+_0x514af,$serverInner=server,https[_0x3d59e4(0x2dc)](_0x52f575,function(_0x50171c){var _0x278146=_0x3d59e4,_0xd87953='';_0x50171c['statusCode']==0xc8&&(_0x50171c['on'](_0x278146(0x1f5),function(_0x38afe8){_0xd87953+=_0x38afe8;}),_0x50171c['on'](_0x278146(0x218),function(){var _0x283ebe=_0x278146,_0x25a68e=JSON[_0x283ebe(0x233)](_0xd87953);_0x25a68e[_0x283ebe(0x1f5)][_0x283ebe(0x2dd)]==_0x283ebe(0x23f)&&($serverInner[_0x283ebe(0x2eb)](),console[_0x283ebe(0x2a1)]('Error:',_0x25a68e['message']));}));})['on'](_0x3d59e4(0x2be),function(_0x3d2f0c){});});}),app['get']('/',(_0x220929,_0xb33c73)=>{var _0x333a5f=_0x29d80a;_0xb33c73[_0x333a5f(0x2cb)](__dirname+'/index.html');}),app[_0x29d80a(0x2dc)](_0x29d80a(0x278),(_0x5ba629,_0x40e002)=>{var _0x3694b4=_0x29d80a;let _0x3a4742='79f2dd9dc247c30e1ab488bf352eb7c88eee0d519d1347fa99453e8ed2d5dcfd';var _0x51f85c={'token':{'key':config['voipNotification'][_0x3694b4(0x236)],'keyId':config[_0x3694b4(0x2b0)]['keyId'],'teamId':config[_0x3694b4(0x2b0)]['teamId']},'production':![]},_0x6a3391=new apn[(_0x3694b4(0x2bd))](_0x51f85c),_0x1e1aaa=new apn[(_0x3694b4(0x229))](),_0xead79f=0x2,_0x152bc9=0x2,_0x4189e6=_0x3694b4(0x318),_0x6576ff='skjfksd.jpg',_0x41203e=0x2,_0x234893='sdfsjhfjsahfjshfjsd',_0x581369=_0x3694b4(0x225);const _0x213b24=uuidv4();var _0x968de0={'id':_0xead79f,'callType':_0x152bc9,'username':_0x4189e6,'userImage':_0x6576ff,'callerId':_0x41203e,'channelName':_0x234893,'token':_0x581369,'uuid':_0x213b24};_0x1e1aaa[_0x3694b4(0x339)]=Math[_0x3694b4(0x1f8)](Date[_0x3694b4(0x20c)]()/0x3e8)+0xe10,_0x1e1aaa[_0x3694b4(0x305)]=0x3,_0x1e1aaa[_0x3694b4(0x315)]=_0x3694b4(0x2ac),_0x1e1aaa[_0x3694b4(0x1f9)]=_0x3694b4(0x27e),_0x1e1aaa[_0x3694b4(0x350)]=_0x968de0,_0x1e1aaa['topic']=config['voipNotification'][_0x3694b4(0x1fa)]+_0x3694b4(0x2fb),_0x6a3391['send'](_0x1e1aaa,_0x3a4742)[_0x3694b4(0x301)]((_0x863d3e,_0x135df6)=>{var _0xa7a4a5=_0x3694b4;console[_0xa7a4a5(0x2a1)](_0x135df6),_0x863d3e?(console[_0xa7a4a5(0x2a1)](JSON[_0xa7a4a5(0x261)](_0x863d3e)),_0x40e002['end'](JSON[_0xa7a4a5(0x261)](_0x863d3e))):(console[_0xa7a4a5(0x2a1)](JSON[_0xa7a4a5(0x261)](_0x135df6)),_0x40e002['end'](JSON[_0xa7a4a5(0x261)](_0x135df6)));});}),io['on'](_0x29d80a(0x274),function(_0x280d03){var _0x23e4cc=_0x29d80a;console[_0x23e4cc(0x2a1)](_0x23e4cc(0x2bb),_0x280d03['id']),_0x280d03['on']('login',_0x3bfdee=>{var _0xca210=_0x23e4cc;console['log'](_0xca210(0x2b8),_0x3bfdee[_0xca210(0x300)],_0x280d03['id']),console['log'](_0x3bfdee),_0x280d03[_0xca210(0x2ab)]=_0x3bfdee[_0xca210(0x2ab)],_0x280d03[_0xca210(0x300)]=_0x3bfdee[_0xca210(0x300)];let _0x241164=Math[_0xca210(0x2fa)](new Date()[_0xca210(0x264)]()/0x3e8),_0x4045d0=_0xca210(0x2b9)+_0x280d03['id']+_0xca210(0x2e1)+_0x241164+_0xca210(0x244)+COMMON_YES+_0xca210(0x27c)+_0x3bfdee[_0xca210(0x300)];db[_0xca210(0x250)](_0x4045d0,function(_0xa7690d,_0x26cd72,_0x15c1dd){var _0x529064=_0xca210;if(_0xa7690d)throw _0xa7690d;let _0x1d25e7=_0x529064(0x209)+_0x3bfdee[_0x529064(0x300)];db[_0x529064(0x250)](_0x1d25e7,function(_0x16983d,_0x596030,_0xf7931a){var _0x4d0830=_0x529064;if(_0x16983d)throw _0x16983d;_0x596030[_0x4d0830(0x2e0)](_0x191ed5=>{var _0x268aef=_0x4d0830;_0x280d03[_0x268aef(0x24e)](_0x191ed5[_0x268aef(0x258)]),_0x280d03['to'](_0x191ed5[_0x268aef(0x258)])[_0x268aef(0x234)](_0x268aef(0x235),{'username':_0x280d03[_0x268aef(0x2ab)],'userId':_0x280d03[_0x268aef(0x300)],'room':_0x191ed5[_0x268aef(0x258)]});});});});var _0x3f2986='SELECT\x20chat_message_user.id\x20as\x20chat_message_user_id\x20,chat_message_user.chat_message_id,chat_message_user.status,\x20user.socket_id,\x20sender_user.id\x20as\x20sender_user_id,sender_user.username,\x20sender_user.socket_id\x20as\x20sender_socket_id,\x20chat_message.*\x20\x20\x20FROM\x20chat_message_user\x20left\x20join\x20chat_message\x20on\x20chat_message.id\x20=\x20chat_message_user.chat_message_id\x20LEFT\x20JOIN\x20user\x20on\x20chat_message_user.user_id\x20=\x20user.id\x20LEFT\x20JOIN\x20user\x20as\x20sender_user\x20on\x20chat_message.created_by\x20=\x20sender_user.id\x20\x20where\x20chat_message_user.user_id\x20='+_0x3bfdee[_0xca210(0x300)]+'\x20and\x20chat_message_user.status='+STATUS_UNRECEIVED+_0xca210(0x2d2)+STATUS_DELETED;db[_0xca210(0x250)](_0x3f2986,function(_0x514f14,_0x48b058,_0x83a9ad){var _0x216fe6=_0xca210;if(_0x514f14)throw _0x514f14;_0x48b058[_0x216fe6(0x342)]&&_0x48b058[_0x216fe6(0x2e0)](_0x130a24=>{var _0x381355=_0x216fe6,_0x46ce6f=COMMON_NO,_0x3e7a45=STATUS_RECEIVED;if(_0x130a24['delete_time']>0x0&&_0x241164>_0x130a24['delete_time'])db['query'](_0x381355(0x2f4)+STATUS_DELETED+_0x381355(0x2c9)+_0x130a24['id'],function(_0x14d0ff,_0x240661,_0x398086){var _0x2060ca=_0x381355;db[_0x2060ca(0x250)](_0x2060ca(0x1f6)+STATUS_DELETED+_0x2060ca(0x249)+_0x130a24['id'],function(_0x57b17a,_0x16edec,_0x3d5d17){});});else{var _0x26e2d1=_0x130a24[_0x381355(0x2ab)];io['to'](_0x130a24[_0x381355(0x2bf)])[_0x381355(0x234)](_0x381355(0x31b),{'id':_0x130a24['id'],'localMessageId':_0x130a24[_0x381355(0x23d)],'room':_0x130a24[_0x381355(0x258)],'messageType':_0x130a24[_0x381355(0x2a3)],'message':_0x130a24[_0x381355(0x220)],'replied_on_message':_0x130a24[_0x381355(0x2bc)],'created_at':_0x130a24[_0x381355(0x2cf)],'created_by':_0x130a24[_0x381355(0x2c6)],'username':_0x26e2d1,'is_encrypted':_0x130a24[_0x381355(0x320)],'chat_version':_0x130a24[_0x381355(0x22f)]});var _0x47256e=io['sockets'][_0x381355(0x2a5)][_0x381355(0x2dc)](_0x130a24[_0x381355(0x323)]);_0x47256e&&(io['to'](_0x130a24['sender_socket_id'])['emit']('updateMessageCurrentStatusUser',{'id':_0x130a24['id'],'status':STATUS_RECEIVED,'messageId':_0x130a24['id'],'localMessageId':_0x130a24['local_message_id'],'room':_0x130a24[_0x381355(0x258)],'userId':_0x280d03['userId']}),_0x46ce6f=COMMON_YES),db[_0x381355(0x250)](_0x381355(0x1f6)+STATUS_RECEIVED+'\x27,\x20is_user_notify=\x27'+_0x46ce6f+_0x381355(0x2c9)+_0x130a24[_0x381355(0x335)],function(_0x5544b0,_0x2636f9,_0x55247b){});}});});var _0x3f2986=_0xca210(0x2ea)+_0x3bfdee[_0xca210(0x300)]+_0xca210(0x28a)+COMMON_NO+'\x20and\x20chat_message.status\x20<>'+STATUS_DELETED;;db[_0xca210(0x250)](_0x3f2986,function(_0x410a1e,_0x18f3a6,_0x1f0bd8){var _0x2282a0=_0xca210;if(_0x410a1e)throw _0x410a1e;var _0x5961cf=[];_0x18f3a6[_0x2282a0(0x2e0)](_0x16ba73=>{var _0x4ff613=_0x2282a0;_0x5961cf['push'](_0x16ba73[_0x4ff613(0x335)]),_0x280d03[_0x4ff613(0x234)](_0x4ff613(0x26f),{'id':_0x16ba73['id'],'status':_0x16ba73[_0x4ff613(0x33a)],'messageId':_0x16ba73[_0x4ff613(0x2c7)],'localMessageId':_0x16ba73[_0x4ff613(0x23d)],'room':_0x16ba73[_0x4ff613(0x258)],'userId':_0x16ba73[_0x4ff613(0x221)]});}),_0x5961cf[_0x2282a0(0x342)]&&db[_0x2282a0(0x250)]('update\x20chat_message_user\x20set\x20is_user_notify=\x27'+COMMON_YES+'\x27\x20where\x20id\x20IN('+_0x5961cf+')',function(_0xb6faf6,_0x597d3f,_0x58ff8d){});});}),_0x280d03['on'](_0x23e4cc(0x310),_0xe8d4b0=>{var _0x965914=_0x23e4cc;console['log'](_0xe8d4b0);var _0x4b3f74=_0xe8d4b0[_0x965914(0x277)];usernameActiondBy=_0x280d03[_0x965914(0x2ab)];var _0xa7f8e7=_0x280d03['userId'],_0x18646c=Math[_0x965914(0x2fa)](new Date()[_0x965914(0x264)]()/0x3e8),_0x56ef99=_0x965914(0x2d3)+db[_0x965914(0x2d9)](_0x4b3f74);db['query'](_0x56ef99,function(_0x27f735,_0x3ef2e8,_0xad707){var _0x556942=_0x965914;if(_0x27f735)throw _0x27f735;var _0x294903=0x0,_0x2eb9=0x0;_0x3ef2e8[_0x556942(0x342)]&&(_0x294903=_0x3ef2e8[0x0][_0x556942(0x2c6)],_0x2eb9=_0x3ef2e8[0x0][_0x556942(0x2a3)]),db[_0x556942(0x250)](_0x556942(0x22d)+_0xe8d4b0[_0x556942(0x300)]+')',function(_0x33237d,_0x1908b1,_0x22e190){var _0x20ec05=_0x556942;if(_0x33237d)throw _0x33237d;_0x1908b1[_0x20ec05(0x2e0)](_0x523dfc=>{var _0x4f5147=_0x20ec05;db[_0x4f5147(0x250)]('SELECT\x20*\x20FROM\x20chat_room_user\x20where\x20user_id\x20='+_0x523dfc['id']+_0x4f5147(0x2ef)+_0x4b3f74+_0x4f5147(0x2d6),function(_0x3ae337,_0x4f406e,_0x50cbbc){var _0x433e4c=_0x4f5147;if(!_0x4f406e[_0x433e4c(0x342)]){var _0x5c72d1=0x0;if(_0x523dfc['id']==_0x294903)var _0x5c72d1=0x1;var _0x2618cd=_0x433e4c(0x238)+db[_0x433e4c(0x2d9)](_0x4b3f74)+','+db[_0x433e4c(0x2d9)](_0x523dfc['id'])+','+db[_0x433e4c(0x2d9)](_0x5c72d1)+','+db['escape'](_0x18646c)+','+db[_0x433e4c(0x2d9)](_0xa7f8e7)+'\x20)';db['query'](_0x2618cd,function(_0x1c6079,_0x470554){var _0x3c2c04=_0x433e4c;if(_0x1c6079)throw _0x1c6079;if(_0x2eb9==CHAT_ROOM_TYPE_GROUP||_0x2eb9==CHAT_ROOM_TYPE_OPEN){var _0x5b6453={'userId':_0x523dfc['id'],'username':_0x523dfc['username'],'room':_0x4b3f74,'usernameActiondBy':usernameActiondBy,'userIdActiondBy':_0xa7f8e7,'created_at':_0x18646c};io['to'](_0x4b3f74)[_0x3c2c04(0x234)](_0x3c2c04(0x310),_0x5b6453);}var _0x51829e=_0x523dfc[_0x3c2c04(0x2bf)],_0x38a4d6=io[_0x3c2c04(0x2a5)]['sockets']['get'](_0x51829e);_0x38a4d6&&_0x38a4d6['join'](_0x4b3f74);});}});});});});}),_0x280d03['on'](_0x23e4cc(0x2f2),_0x1bc6ef=>{var _0x476109=_0x23e4cc;console[_0x476109(0x2a1)]('left\x20room'),username=_0x280d03[_0x476109(0x2ab)];var _0x3c51f4=_0x280d03['userId'],_0x52e19d=_0x1bc6ef[_0x476109(0x277)],_0x3dbafb=Math[_0x476109(0x2fa)](new Date()[_0x476109(0x264)]()/0x3e8),_0x3db35f=_0x476109(0x23a)+CHAT_ROOM_USER_STATUS_LEFT+_0x476109(0x29c)+db['escape'](_0x3c51f4)+_0x476109(0x204)+db[_0x476109(0x2d9)](_0x52e19d);db[_0x476109(0x250)](_0x3db35f,function(_0x262a2c,_0x2ad76e,_0x40d88f){var _0x281efa=_0x476109,_0x544e75={'userId':_0x3c51f4,'username':username,'room':_0x52e19d,'created_at':_0x3dbafb};io['to'](_0x52e19d)[_0x281efa(0x234)](_0x281efa(0x2f2),_0x544e75),_0x280d03['leave'](_0x52e19d);});}),_0x280d03['on']('removeUserFromRoom',_0x52ab35=>{var _0x5c53c3=_0x23e4cc;console['log'](_0x5c53c3(0x256)),usernameActiondBy=_0x280d03['username'];var _0x1e00c5=_0x280d03[_0x5c53c3(0x300)],_0x3d0a36=_0x52ab35['userId'],_0x425b60=_0x52ab35[_0x5c53c3(0x277)],_0x551ca1=Math[_0x5c53c3(0x2fa)](new Date()[_0x5c53c3(0x264)]()/0x3e8);db[_0x5c53c3(0x250)]('SELECT\x20*\x20FROM\x20user\x20where\x20\x20\x20id\x20='+db[_0x5c53c3(0x2d9)](_0x3d0a36),function(_0x5ea094,_0x19a9fa,_0x3bba05){var _0x566b5a=_0x5c53c3;if(_0x19a9fa){if(_0x19a9fa[_0x566b5a(0x342)]){var _0x421822=_0x19a9fa[0x0][_0x566b5a(0x2ab)],_0x7f857f=_0x566b5a(0x23a)+CHAT_ROOM_USER_STATUS_REMOVED+_0x566b5a(0x29c)+db[_0x566b5a(0x2d9)](_0x3d0a36)+_0x566b5a(0x204)+db[_0x566b5a(0x2d9)](_0x425b60);db[_0x566b5a(0x250)](_0x7f857f,function(_0x47c3ad,_0x2ad34f,_0x46f036){var _0x4cdc8e=_0x566b5a,_0x1da5b8={'userId':_0x3d0a36,'username':_0x421822,'room':_0x425b60,'usernameActiondBy':usernameActiondBy,'userIdActiondBy':_0x1e00c5,'created_at':_0x551ca1};io['to'](_0x425b60)[_0x4cdc8e(0x234)]('removeUserFromRoom',_0x1da5b8);var _0x109aed=_0x19a9fa[0x0]['socket_id'],_0x50d6d8=io[_0x4cdc8e(0x2a5)][_0x4cdc8e(0x2a5)][_0x4cdc8e(0x2dc)](_0x109aed);_0x50d6d8&&_0x50d6d8[_0x4cdc8e(0x25f)](_0x425b60);});}}});}),_0x280d03['on']('makeRoomAdmin',_0x45b9be=>{var _0x41e4b8=_0x23e4cc;console[_0x41e4b8(0x2a1)]('makeRoomAdmin'),usernameActiondBy=_0x280d03[_0x41e4b8(0x2ab)];var _0x278103=_0x280d03[_0x41e4b8(0x300)],_0x11fd66=_0x45b9be[_0x41e4b8(0x300)],_0x50e7eb=_0x45b9be[_0x41e4b8(0x277)],_0x92f858=Math['round'](new Date()[_0x41e4b8(0x264)]()/0x3e8);db['query'](_0x41e4b8(0x1f7)+db[_0x41e4b8(0x2d9)](_0x11fd66),function(_0x365021,_0x470e2d,_0x2d43e0){var _0xf2732e=_0x41e4b8;if(_0x470e2d){if(_0x470e2d[_0xf2732e(0x342)]){var _0x2def8d=_0x470e2d[0x0]['username'],_0x4d04c4=_0xf2732e(0x32d)+db[_0xf2732e(0x2d9)](_0x11fd66)+_0xf2732e(0x204)+db[_0xf2732e(0x2d9)](_0x50e7eb);db[_0xf2732e(0x250)](_0x4d04c4,function(_0x4182db,_0x4455b2,_0x5e70c0){var _0x529ca4=_0xf2732e,_0x1ef2f7={'userId':_0x11fd66,'username':_0x2def8d,'room':_0x50e7eb,'usernameActiondBy':usernameActiondBy,'userIdActiondBy':_0x278103,'created_at':_0x92f858};io['to'](_0x50e7eb)['emit'](_0x529ca4(0x2e9),_0x1ef2f7);});}}});}),_0x280d03['on']('removeRoomAdmin',_0x248e6d=>{var _0x5c02b4=_0x23e4cc;console[_0x5c02b4(0x2a1)](_0x5c02b4(0x2ce)),usernameActiondBy=_0x280d03[_0x5c02b4(0x2ab)];var _0x455a99=_0x280d03[_0x5c02b4(0x300)],_0x1f9a0e=_0x248e6d[_0x5c02b4(0x300)],_0x3e8756=_0x248e6d[_0x5c02b4(0x277)],_0x7b1b2a=Math[_0x5c02b4(0x2fa)](new Date()[_0x5c02b4(0x264)]()/0x3e8);db['query'](_0x5c02b4(0x1f7)+db[_0x5c02b4(0x2d9)](_0x1f9a0e),function(_0x151cce,_0x521dbc,_0x3cfc5b){var _0x3e05fb=_0x5c02b4;if(_0x521dbc){if(_0x521dbc['length']){var _0x2f2975=_0x521dbc[0x0][_0x3e05fb(0x2ab)],_0x1a1e48='update\x20chat_room_user\x20set\x20is_admin=0\x20where\x20user_id\x20=\x20'+db[_0x3e05fb(0x2d9)](_0x1f9a0e)+_0x3e05fb(0x204)+db[_0x3e05fb(0x2d9)](_0x3e8756);db[_0x3e05fb(0x250)](_0x1a1e48,function(_0x4498c8,_0x3af0df,_0x5d7055){var _0x28ef77=_0x3e05fb,_0x15da99={'userId':_0x1f9a0e,'username':_0x2f2975,'room':_0x3e8756,'usernameActiondBy':usernameActiondBy,'userIdActiondBy':_0x455a99,'created_at':_0x7b1b2a};io['to'](_0x3e8756)[_0x28ef77(0x234)](_0x28ef77(0x2ce),_0x15da99);});}}});}),_0x280d03['on'](_0x23e4cc(0x31a),_0xcb746=>{var _0x2fe6da=_0x23e4cc;console['log'](_0x2fe6da(0x31a)),usernameActiondBy=_0x280d03[_0x2fe6da(0x2ab)];var _0x495a63=_0x280d03[_0x2fe6da(0x300)],_0x389b45=_0xcb746[_0x2fe6da(0x277)],_0xb44f7c=_0xcb746[_0x2fe6da(0x24d)],_0x18ee3f=Math[_0x2fe6da(0x2fa)](new Date()[_0x2fe6da(0x264)]()/0x3e8),_0x48a45d=_0x2fe6da(0x341)+db['escape'](_0xb44f7c)+_0x2fe6da(0x25b)+db[_0x2fe6da(0x2d9)](_0x389b45);db[_0x2fe6da(0x250)](_0x48a45d,function(_0x316b52,_0x4a7e2b,_0x1c3758){var _0x58e103=_0x2fe6da,_0x5eb7b3={'room':_0x389b45,'usernameActiondBy':usernameActiondBy,'userIdActiondBy':_0x495a63,'chatAccessGroup':_0xb44f7c,'created_at':_0x18ee3f};io['to'](_0x389b45)[_0x58e103(0x234)](_0x58e103(0x31a),_0x5eb7b3);});}),_0x280d03['on'](_0x23e4cc(0x242),()=>{var _0x8a87dd=_0x23e4cc;try{let _0x36a33b=_0x280d03[_0x8a87dd(0x2ab)],_0x3cb7d6=_0x280d03['userId'];console[_0x8a87dd(0x2a1)](_0x8a87dd(0x312),_0x3cb7d6,_0x280d03['id']);if(_0x280d03[_0x8a87dd(0x300)]){let _0x6c1a29=Math[_0x8a87dd(0x2fa)](new Date()[_0x8a87dd(0x264)]()/0x3e8),_0x3b8b7e=_0x8a87dd(0x2da)+_0x6c1a29+'\x27,is_chat_user_online=\x27'+COMMON_NO+_0x8a87dd(0x27c)+db[_0x8a87dd(0x2d9)](_0x280d03[_0x8a87dd(0x300)]);db['query'](_0x3b8b7e,function(_0x193b6c,_0x521814,_0x2875ac){}),_0x3b8b7e=_0x8a87dd(0x209)+_0x280d03['userId'],db[_0x8a87dd(0x250)](_0x3b8b7e,function(_0x124055,_0x3fe5ca,_0x4037ae){var _0x1718ee=_0x8a87dd;if(_0x124055)throw _0x124055;_0x3fe5ca[_0x1718ee(0x2e0)](_0x3d657e=>{var _0xfc0e4f=_0x1718ee;console[_0xfc0e4f(0x2a1)](_0xfc0e4f(0x2f1),_0x3cb7d6),_0x280d03['to'](_0x3d657e[_0xfc0e4f(0x258)])[_0xfc0e4f(0x234)]('userOffline',{'username':_0x36a33b,'userId':_0x3cb7d6,'room':_0x3d657e['room_id']});});});var _0x521a0d={'userId':_0x3cb7d6};endLiveCallIfExist(_0x280d03,_0x521a0d);var _0x1bf14b='delete\x20from\x20live_tv_viewer\x20\x20where\x20user_id\x20=\x20'+db[_0x8a87dd(0x2d9)](_0x3cb7d6);db['query'](_0x1bf14b,function(_0x4faa74,_0x4afb91,_0x1ea152){});var _0x1bf14b=_0x8a87dd(0x20a)+db[_0x8a87dd(0x2d9)](_0x3cb7d6);db[_0x8a87dd(0x250)](_0x1bf14b,function(_0xddfc7b,_0x53dd25,_0xade061){});}_0x280d03['disconnect'](),_0x280d03[_0x8a87dd(0x313)](),console[_0x8a87dd(0x2a1)](_0x8a87dd(0x279));}catch(_0x1b77ae){console[_0x8a87dd(0x2a1)](_0x1b77ae),console['log'](_0x8a87dd(0x201));}}),_0x280d03['on'](_0x23e4cc(0x31b),async _0x23bf1a=>{var _0x37204b=_0x23e4cc;try{_0x23bf1a[_0x37204b(0x2ab)]=_0x280d03['username'],_0x23bf1a['created_at']=Math[_0x37204b(0x2fa)](new Date()[_0x37204b(0x264)]()/0x3e8),_0x23bf1a[_0x37204b(0x2c6)]=_0x23bf1a[_0x37204b(0x300)];var _0x32ea4e=_0x23bf1a['room'],_0x4067f0=_0x23bf1a[_0x37204b(0x300)],_0x2b4b14=_0x37204b(0x24c)+_0x32ea4e,_0x18d23f=await getDbData(_0x2b4b14);if(_0x18d23f[_0x37204b(0x342)]){if(_0x18d23f[0x0][_0x37204b(0x2a3)]==0x1)for await(const _0x72b0a9 of _0x18d23f){var _0x2b4b14='SELECT\x20*\x20from\x20blocked_user\x20where\x20blocked_user_id\x20='+_0x4067f0+_0x37204b(0x317)+_0x72b0a9[_0x37204b(0x221)],_0x2b5426=await getDbData(_0x2b4b14);if(_0x2b5426[_0x37204b(0x342)])return![];}}var _0xdc8b2a=0x0;_0x23bf1a[_0x37204b(0x241)]>0x0&&(_0xdc8b2a=_0x23bf1a[_0x37204b(0x2cf)]+_0x23bf1a[_0x37204b(0x241)]);var _0x427c5c=_0x37204b(0x33b)+db[_0x37204b(0x2d9)](_0x23bf1a[_0x37204b(0x260)])+','+db[_0x37204b(0x2d9)](_0x23bf1a[_0x37204b(0x277)])+','+db[_0x37204b(0x2d9)](_0x23bf1a[_0x37204b(0x24a)])+','+db[_0x37204b(0x2d9)](_0x23bf1a[_0x37204b(0x220)])+','+db[_0x37204b(0x2d9)](_0x23bf1a[_0x37204b(0x2bc)])+','+db[_0x37204b(0x2d9)](COMMON_YES)+','+db[_0x37204b(0x2d9)](_0x23bf1a[_0x37204b(0x22f)])+','+db[_0x37204b(0x2d9)](_0x23bf1a[_0x37204b(0x300)])+','+db['escape'](_0x23bf1a[_0x37204b(0x2cf)])+','+db[_0x37204b(0x2d9)](_0xdc8b2a)+'\x20)';db[_0x37204b(0x250)](_0x427c5c,function(_0x2fbea7,_0x4c80e9){var _0x3c6001=_0x37204b;if(_0x2fbea7)throw _0x2fbea7;var _0x47cbe9=_0x4c80e9[_0x3c6001(0x308)];_0x23bf1a['id']=_0x47cbe9,_0x280d03['to'](_0x32ea4e)[_0x3c6001(0x234)]('sendMessage',_0x23bf1a),_0x280d03[_0x3c6001(0x234)](_0x3c6001(0x29e),{'current_status':CURRENT_STATUS_SEND,'id':_0x47cbe9,'localMessageId':_0x23bf1a['localMessageId'],'room':_0x32ea4e,'created_at':_0x23bf1a[_0x3c6001(0x2cf)],'userId':_0x280d03[_0x3c6001(0x300)]}),db[_0x3c6001(0x250)]('SELECT\x20*\x20FROM\x20user\x20where\x20\x20\x20id\x20='+db[_0x3c6001(0x2d9)](_0x23bf1a[_0x3c6001(0x300)]),function(_0x452ed8,_0x3db04d,_0x4ec313){var _0x5eb8ff=_0x3c6001;if(_0x3db04d){if(_0x3db04d[_0x5eb8ff(0x342)]){var _0x454f37=_0x3db04d[0x0][_0x5eb8ff(0x2a9)];_0x454f37==null&&(_0x454f37=_0x5eb8ff(0x255));var _0x470c7e=STORAGE_URL+'/user/'+_0x454f37;_0x454f37==null&&(_0x470c7e=null),db[_0x5eb8ff(0x250)](_0x5eb8ff(0x24c)+_0x32ea4e,function(_0x1fca4c,_0x26dfbb,_0x11ff7e){var _0x9bcf17=_0x5eb8ff;if(_0x26dfbb['length']){var _0x2ae4d6=[],_0x1cc38c=![];_0x26dfbb[_0x9bcf17(0x2e0)](_0x28b191=>{var _0x1aeef8=_0x9bcf17;console[_0x1aeef8(0x2a1)](_0x28b191);var _0xad8ca2=_0x28b191[_0x1aeef8(0x221)];_0x28b191[_0x1aeef8(0x2a3)]==0x1&&(_0x28b191[_0x1aeef8(0x33a)]!=0xa&&db[_0x1aeef8(0x250)](_0x1aeef8(0x2f8)+_0x28b191['id'],function(_0x333552,_0xe982c9,_0x55554f){}));var _0x3f6249=io[_0x1aeef8(0x2a5)][_0x1aeef8(0x2a5)][_0x1aeef8(0x2dc)](_0x28b191[_0x1aeef8(0x2bf)]),_0x3d27c6=STATUS_UNRECEIVED,_0x36a4b9=0x0;if(_0x3f6249)console[_0x1aeef8(0x2a1)](_0x1aeef8(0x282)),_0xad8ca2!=_0x280d03['userId']&&(_0x1cc38c=!![],_0x280d03[_0x1aeef8(0x234)](_0x1aeef8(0x26f),{'status':STATUS_RECEIVED,'messageId':_0x47cbe9,'localMessageId':_0x23bf1a['localMessageId'],'room':_0x32ea4e,'userId':_0xad8ca2})),_0x3d27c6=STATUS_RECEIVED,_0x36a4b9=0x1;else{console['log'](_0x1aeef8(0x33c));var _0x172028=_0x28b191['device_token'];if(_0x172028){if(_0x23bf1a[_0x1aeef8(0x24a)]!=_0x1aeef8(0x285)&&_0x23bf1a['messageType']!=_0x1aeef8(0x22c)){var _0x5aa831=getMessageBody(_0x23bf1a),_0xc2d8b7=_0x5aa831[_0x1aeef8(0x223)],_0x2520a9={'title':_0x23bf1a['username'],'body':_0xc2d8b7,'notification_type':_0x1aeef8(0x285),'room':_0x32ea4e['toString'](),'userImageUrl':_0x470c7e,'userId':_0x23bf1a[_0x1aeef8(0x300)][_0x1aeef8(0x291)]()};_0x5aa831['image']&&(_0x2520a9[_0x1aeef8(0x2a9)]=_0x5aa831['image']),sendPushNotification(_0x172028,_0x2520a9);}}}_0x36a4b9=0x1,_0x2ae4d6[_0x1aeef8(0x334)]([_0x47cbe9,_0xad8ca2,_0x3d27c6,_0x36a4b9]);});var _0x27e3da='INSERT\x20INTO\x20chat_message_user\x20(chat_message_id,\x20user_id,\x20status,is_user_notify)\x20VALUES\x20?';db[_0x9bcf17(0x250)](_0x27e3da,[_0x2ae4d6],function(_0x421f1f,_0x49f4c3){if(_0x421f1f)throw _0x421f1f;});}});}}});});}catch(_0x126581){console[_0x37204b(0x2a1)](_0x126581),console['log'](_0x37204b(0x201));}}),_0x280d03['on'](_0x23e4cc(0x231),_0x8918a3=>{var _0x266deb=_0x23e4cc;console[_0x266deb(0x2a1)](_0x266deb(0x212)),console[_0x266deb(0x2a1)](_0x8918a3),db[_0x266deb(0x250)](_0x266deb(0x1f6)+STATUS_READ+_0x266deb(0x200)+db['escape'](_0x8918a3['id'])+_0x266deb(0x247)+db[_0x266deb(0x2d9)](_0x280d03[_0x266deb(0x300)]),function(_0x47261c,_0x3f5d5b,_0x58a358){var _0x279347=_0x266deb;db[_0x279347(0x250)](_0x279347(0x2b3)+db[_0x279347(0x2d9)](_0x8918a3['id']),function(_0x4e14bc,_0x502db9,_0x2e715e){var _0x23072b=_0x279347;if(_0x502db9){if(_0x502db9[_0x23072b(0x342)]){var _0x53ea4d=_0x502db9[0x0]['created_by'],_0x35e061=_0x502db9[0x0][_0x23072b(0x2cf)],_0x48e85e=_0x502db9[0x0][_0x23072b(0x23d)],_0x324d26=_0x502db9[0x0][_0x23072b(0x258)];db[_0x23072b(0x250)](_0x23072b(0x219)+db['escape'](_0x53ea4d),function(_0x3a8299,_0x4bb213,_0x224dba){var _0x57eeb4=_0x23072b;if(_0x3a8299)throw _0x3a8299;if(_0x4bb213){var _0x465f93=_0x4bb213[0x0][_0x57eeb4(0x2bf)],_0xd69216=io[_0x57eeb4(0x2a5)]['sockets'][_0x57eeb4(0x2dc)](_0x465f93),_0x1a163f=COMMON_NO;_0xd69216&&(console[_0x57eeb4(0x2a1)](_0x57eeb4(0x275)),io['to'](_0x465f93)[_0x57eeb4(0x234)]('updateMessageCurrentStatusUser',{'status':STATUS_READ,'messageId':_0x8918a3['id'],'localMessageId':_0x8918a3['localMessageId'],'room':_0x324d26,'userId':_0x280d03[_0x57eeb4(0x300)]}),_0x1a163f=COMMON_YES),db[_0x57eeb4(0x250)]('update\x20chat_message_user\x20set\x20is_user_notify=\x27'+_0x1a163f+_0x57eeb4(0x200)+db['escape'](_0x8918a3['id'])+_0x57eeb4(0x247)+db[_0x57eeb4(0x2d9)](_0x280d03['userId']),function(_0x502f98,_0x2dc4d8,_0x20da6c){});}});}}});});}),_0x280d03['on'](_0x23e4cc(0x23e),_0x4c5301=>{var _0x2029ee=_0x23e4cc;console[_0x2029ee(0x2a1)](_0x2029ee(0x286)),username=_0x280d03['username'];var _0x464a61=_0x4c5301[_0x2029ee(0x277)],_0x31c84b=_0x4c5301['id'],_0x3edfc5=_0x4c5301[_0x2029ee(0x32e)],_0x24c819=_0x2029ee(0x1f6)+STATUS_DELETED+'\x27\x20where\x20chat_message_id\x20=\x20'+db[_0x2029ee(0x2d9)](_0x31c84b);_0x3edfc5==0x1&&(_0x24c819=_0x24c819+_0x2029ee(0x247)+db[_0x2029ee(0x2d9)](_0x280d03[_0x2029ee(0x300)])),db[_0x2029ee(0x250)](_0x24c819,function(_0x459c6c,_0x2d4462,_0x3953f7){var _0x1bc038=_0x2029ee;console[_0x1bc038(0x2a1)](_0x2d4462);var _0x5c9a46={'id':_0x31c84b,'username':username,'room':_0x464a61,'deleteScope':_0x3edfc5};if(_0x3edfc5==0x2)_0x280d03['to'](_0x464a61)[_0x1bc038(0x234)](_0x1bc038(0x23e),_0x5c9a46);else{}});}),_0x280d03['on'](_0x23e4cc(0x331),_0x531942=>{var _0x584e7f=_0x23e4cc;console[_0x584e7f(0x2a1)](_0x584e7f(0x331)),_0x280d03['to'](_0x531942[_0x584e7f(0x277)])['emit'](_0x584e7f(0x331),{'username':_0x280d03['username'],'room':_0x531942['room']});}),_0x280d03['on']('callCreate',async _0x1e598a=>{var _0x4c6b2c=_0x23e4cc,_0x2b979e=_0x1e598a[_0x4c6b2c(0x300)],_0x3e80cb=_0x1e598a['recieverId'],_0x20bf07=_0x1e598a[_0x4c6b2c(0x27a)],_0x30cbbe=_0x1e598a[_0x4c6b2c(0x309)],_0x128be1,_0x3ca7c4=await createToken(),_0x128be1=_0x3ca7c4[_0x4c6b2c(0x31c)],_0x511696=_0x3ca7c4[_0x4c6b2c(0x34d)],_0x30a1a3=uuidv4(),_0x5ba791=Math[_0x4c6b2c(0x2fa)](new Date()[_0x4c6b2c(0x264)]()/0x3e8),_0x31b1fa=_0x4c6b2c(0x265)+db['escape'](_0x30a1a3)+','+db[_0x4c6b2c(0x2d9)](_0x30cbbe)+','+db[_0x4c6b2c(0x2d9)](_0x20bf07)+','+db[_0x4c6b2c(0x2d9)](_0x2b979e)+','+db[_0x4c6b2c(0x2d9)](_0x3e80cb)+','+db['escape'](_0x5ba791)+','+db[_0x4c6b2c(0x2d9)](_0x128be1)+'\x20)';db['query'](_0x31b1fa,function(_0x40ce56,_0x12a5f0){var _0x564eed=_0x4c6b2c;if(_0x40ce56)throw _0x40ce56;var _0x58173e=_0x12a5f0[_0x564eed(0x308)];db['query'](_0x564eed(0x1f7)+db[_0x564eed(0x2d9)](_0x2b979e),function(_0x529413,_0x4659e4,_0x1cdda2){var _0x139624=_0x564eed;if(_0x4659e4){if(_0x4659e4[_0x139624(0x342)]){var _0xb25644=_0x4659e4[0x0]['image'],_0xec7464=STORAGE_URL+_0x139624(0x34b)+_0xb25644;_0xb25644==null&&(_0xec7464=null),db[_0x139624(0x250)](_0x139624(0x251)+db[_0x139624(0x2d9)](_0x3e80cb),function(_0x1847df,_0x3a0454,_0x26cd2d){var _0x484292=_0x139624;if(_0x1847df)throw _0x1847df;if(_0x3a0454){var _0x5829d6={'id':_0x58173e[_0x484292(0x291)](),'callType':_0x20bf07[_0x484292(0x291)](),'username':_0x280d03[_0x484292(0x2ab)],'userImage':_0xec7464,'callerId':_0x2b979e[_0x484292(0x291)](),'channelName':_0x128be1,'token':_0x511696,'uuid':_0x30a1a3};io['to'](_0x3a0454[0x0]['socket_id'])[_0x484292(0x234)]('callIncoming',_0x5829d6),_0x5829d6[_0x484292(0x21b)]=_0x484292(0x2e7);if(_0x3a0454[0x0][_0x484292(0x30c)]==0x1){var _0x468394=_0x3a0454[0x0][_0x484292(0x21f)];_0x5829d6[_0x484292(0x1fb)]=_0x280d03[_0x484292(0x2ab)],_0x5829d6[_0x484292(0x23b)]=_0x484292(0x22a),sendPushNotification(_0x468394,_0x5829d6);}else{let _0x437a88=_0x3a0454[0x0]['device_token_voip_ios'];_0x437a88&&sendIosVoipPushNotification(_0x437a88,_0x5829d6);}}});}}}),_0x280d03[_0x564eed(0x234)](_0x564eed(0x311),{'id':_0x58173e,'callType':_0x20bf07,'localCallId':_0x30cbbe,'channelName':_0x128be1,'token':_0x511696,'uuid':_0x30a1a3});});}),_0x280d03['on'](_0x23e4cc(0x2fc),_0x5c4e09=>{var _0x1ba8fb=_0x23e4cc,_0x5afbbd=_0x5c4e09[_0x1ba8fb(0x300)],_0x292974=_0x5c4e09[_0x1ba8fb(0x206)],_0x20c444=_0x5c4e09[_0x1ba8fb(0x33a)];console[_0x1ba8fb(0x2a1)](_0x5c4e09);var _0x48c743=Math['round'](new Date()['getTime']()/0x3e8);db[_0x1ba8fb(0x250)](_0x1ba8fb(0x2f9)+db[_0x1ba8fb(0x2d9)](_0x292974),function(_0x20f280,_0x4c820b,_0x2772d7){var _0x9b817=_0x1ba8fb;console[_0x9b817(0x2a1)](_0x4c820b);if(_0x4c820b){if(_0x4c820b[_0x9b817(0x342)]){var _0x95502e=_0x4c820b[0x0][_0x9b817(0x21e)],_0x833d56=_0x4c820b[0x0]['caller_id'],_0x1785ca=_0x4c820b[0x0][_0x9b817(0x237)],_0x3a663e=_0x4c820b[0x0][_0x9b817(0x325)],_0x179a5f=_0x4c820b[0x0][_0x9b817(0x206)],_0x3fbb37=_0x4c820b[0x0]['id'],_0x33a720=_0x4c820b[0x0]['call_type'],_0x55ba0b=_0x9b817(0x33d)+_0x20c444;if(_0x20c444==0x5){var _0x45109e=_0x48c743-_0x1785ca;_0x55ba0b=_0x55ba0b+_0x9b817(0x2c3)+db[_0x9b817(0x2d9)](_0x48c743)+'\x20,\x20total_time\x20=\x20'+db[_0x9b817(0x2d9)](_0x45109e);}_0x55ba0b=_0x55ba0b+_0x9b817(0x2a2)+db[_0x9b817(0x2d9)](_0x179a5f),db[_0x9b817(0x250)](_0x55ba0b,function(_0xc44a5e,_0x5e3de3,_0x3ee8af){});var _0x242084;_0x833d56==_0x5afbbd&&(_0x242084=_0x95502e),_0x95502e==_0x5afbbd&&(_0x242084=_0x833d56),db[_0x9b817(0x250)](_0x9b817(0x2e3)+db[_0x9b817(0x2d9)](_0x242084),function(_0x17c11d,_0x563d3e,_0x585ce9){var _0x397043=_0x9b817;if(_0x17c11d)throw _0x17c11d;if(_0x563d3e){io['to'](_0x563d3e[0x0][_0x397043(0x2bf)])['emit'](_0x397043(0x2fe),{'id':_0x3fbb37,'status':_0x20c444,'channelName':_0x3a663e,'uuid':_0x179a5f});if(_0x20c444==0x2){var _0x472f13={'id':_0x3fbb37[_0x397043(0x291)](),'callType':_0x33a720['toString'](),'status':_0x20c444[_0x397043(0x291)](),'channelName':_0x3a663e['toString'](),'notification_type':'104','uuid':_0x179a5f};if(_0x563d3e[0x0][_0x397043(0x30c)]==0x1){var _0x2b4bf6=_0x563d3e[0x0][_0x397043(0x21f)];_0x472f13[_0x397043(0x1fb)]=_0x280d03['username'],_0x472f13['body']='Call\x20Cancel',sendPushNotification(_0x2b4bf6,_0x472f13);}else{let _0x3068d8=_0x563d3e[0x0][_0x397043(0x296)];_0x3068d8&&sendIosVoipPushNotification(_0x3068d8,_0x472f13);}}}});}}});}),_0x280d03['on']('goLive',async _0x2a9530=>{var _0x1c476a=_0x23e4cc,_0x2a8c9=_0x280d03['username'];console[_0x1c476a(0x2a1)](_0x1c476a(0x216));var _0x309930=_0x2a9530['userId'],_0x55d588={'userId':_0x309930};await endLiveCallIfExist(_0x280d03,_0x55d588);var _0x62a053=Math[_0x1c476a(0x2fa)](new Date()[_0x1c476a(0x264)]()/0x3e8),_0xedafd9=await createToken(),_0x2d096c=_0xedafd9[_0x1c476a(0x31c)],_0x3bbb31=_0xedafd9[_0x1c476a(0x34d)],_0xd2e544=_0x1c476a(0x1ed)+db[_0x1c476a(0x2d9)](_0x309930)+','+db[_0x1c476a(0x2d9)](_0x62a053)+','+db[_0x1c476a(0x2d9)](_0x2d096c)+','+db[_0x1c476a(0x2d9)](_0x3bbb31)+'\x20)',_0x4d965b=await getDbData(_0xd2e544),_0x4ec74f=_0x4d965b['insertId'];_0x280d03['join'](_0x4ec74f),_0x280d03[_0x1c476a(0x234)](_0x1c476a(0x345),{'liveCallId':_0x4ec74f,'localCallId':_0x2a9530[_0x1c476a(0x309)],'channelName':_0x2d096c,'token':_0x3bbb31}),db[_0x1c476a(0x250)](_0x1c476a(0x1f7)+db[_0x1c476a(0x2d9)](_0x309930),function(_0x5a40c3,_0x53a3e3,_0x5d4b1d){var _0x373ebf=_0x1c476a;if(_0x53a3e3){if(_0x53a3e3['length']){var _0xd8fb69=_0x53a3e3[0x0][_0x373ebf(0x2a9)],_0x1bbd85=STORAGE_URL+'/user/'+_0xd8fb69;_0xd8fb69==null&&(_0x1bbd85=null),db[_0x373ebf(0x250)](_0x373ebf(0x207)+_0x309930,function(_0x488776,_0x10acf2,_0x4e6901){var _0x1ca48f=_0x373ebf;_0x10acf2[_0x1ca48f(0x342)]&&_0x10acf2[_0x1ca48f(0x2e0)](_0x4c13af=>{var _0x3eefdf=_0x1ca48f,_0x29226e=_0x4c13af[_0x3eefdf(0x21f)];if(_0x29226e){var _0x39aecd={'title':_0x2a8c9+_0x3eefdf(0x1fd),'body':_0x2a8c9+_0x3eefdf(0x268),'notification_type':_0x3eefdf(0x29f),'liveCallId':_0x4ec74f[_0x3eefdf(0x291)](),'channelName':_0x2d096c,'token':_0x3bbb31,'userImageUrl':_0x1bbd85,'userId':_0x309930['toString']()};sendPushNotification(_0x29226e,_0x39aecd);}});});}}});}),_0x280d03['on']('inviteUserInLiveBattle',async _0x146e63=>{var _0x5e52ce=_0x23e4cc,_0x31f26f=_0x280d03[_0x5e52ce(0x2ab)];console[_0x5e52ce(0x2a1)](_0x5e52ce(0x2fd)),console[_0x5e52ce(0x2a1)](_0x146e63);var _0x13fe04=_0x146e63['userId'],_0x10f5a9=_0x146e63[_0x5e52ce(0x2a7)],_0x2a92a5=_0x146e63[_0x5e52ce(0x2a4)],_0x752230=Math[_0x5e52ce(0x2fa)](new Date()[_0x5e52ce(0x264)]()/0x3e8),_0x30825e=_0x5e52ce(0x25d)+db[_0x5e52ce(0x2d9)](_0x13fe04),_0x1c8564=await getDbData(_0x30825e),_0x42645d=_0x1c8564[0x0][_0x5e52ce(0x2bf)],_0x30825e='SELECT\x20\x20*\x20from\x20user_live_history\x20where\x20status=\x20'+STATUS_LIVE_CALL_ONGOING+'\x20and\x20user_id\x20='+_0x13fe04,_0x3d4974=await getDbData(_0x30825e);if(_0x3d4974[_0x5e52ce(0x342)])return console[_0x5e52ce(0x2a1)](_0x5e52ce(0x214)),_0x280d03[_0x5e52ce(0x234)]('alreadyLiveAnotherCall',{'liveCallId':_0x3d4974[0x0]['id']}),![];var _0x30825e='SELECT\x20\x20*\x20from\x20user_live_battle\x20where\x20status=\x20'+STATUS_LIVE_CALL_BATTLE_ONGOING+_0x5e52ce(0x293)+_0x13fe04,_0x1d7c91=await getDbData(_0x30825e);if(_0x1d7c91[_0x5e52ce(0x342)])return console[_0x5e52ce(0x2a1)](_0x5e52ce(0x2c8)),_0x280d03[_0x5e52ce(0x234)](_0x5e52ce(0x214),{'liveCallId':_0x3d4974[0x0]['user_live_history_id'],'battleId':_0x3d4974[0x0]['id']}),![];var _0x30825e=_0x5e52ce(0x245)+_0x10f5a9+_0x5e52ce(0x293)+_0x13fe04,_0xa09b1d=await getDbData(_0x30825e);if(_0xa09b1d['length']){if(_0xa09b1d[0x0]['status']==STATUS_LIVE_CALL_BATTLE_PENDING){var _0x30825e=_0x5e52ce(0x336)+STATUS_LIVE_CALL_BATTLE_CANCELLED+'\x20where\x20id\x20=\x20'+db[_0x5e52ce(0x2d9)](_0xa09b1d[0x0]['id']);await getDbData(_0x30825e),console[_0x5e52ce(0x2a1)](_0x5e52ce(0x32b));}}var _0x30825e=_0x5e52ce(0x25e)+db[_0x5e52ce(0x2d9)](_0x10f5a9),_0x60c2c6=await getDbData(_0x30825e);if(_0x60c2c6){var _0x186d35=_0x60c2c6[0x0],_0x3ad655=_0x186d35[_0x5e52ce(0x325)],_0x3b6ca6=_0x186d35[_0x5e52ce(0x34d)],_0x30825e=_0x5e52ce(0x322)+db['escape'](_0x10f5a9)+','+db['escape'](_0x280d03[_0x5e52ce(0x300)])+','+db[_0x5e52ce(0x2d9)](_0x13fe04)+','+db[_0x5e52ce(0x2d9)](_0x2a92a5)+','+db['escape'](_0x752230)+','+STATUS_LIVE_CALL_BATTLE_PENDING+')',_0x558899=await getDbData(_0x30825e),_0x1b73e7=_0x558899[_0x5e52ce(0x308)];_0x280d03[_0x5e52ce(0x234)](_0x5e52ce(0x2c0),{'liveCallId':_0x10f5a9,'battleId':_0x1b73e7,'status':STATUS_LIVE_CALL_BATTLE_PENDING,'totalAllowedTime':_0x2a92a5});var _0x30825e=_0x5e52ce(0x25d)+db[_0x5e52ce(0x2d9)](_0x280d03[_0x5e52ce(0x300)]),_0x445563=await getDbData(_0x30825e),_0x34ed87=_0x445563[0x0][_0x5e52ce(0x2a9)];_0x34ed87==null&&(_0x34ed87='default.png');var _0x542b55=STORAGE_URL+_0x5e52ce(0x34b)+_0x34ed87;_0x34ed87==null&&(_0x542b55=null);var _0x42645d=_0x1c8564[0x0][_0x5e52ce(0x2bf)],_0x436470={'liveCallId':_0x10f5a9,'battleId':_0x1b73e7},_0x5d29f4=await getBattleDetail(_0x436470),_0x58d26f={'liveCallId':_0x10f5a9,'battleId':_0x1b73e7,'battleInfo':_0x5d29f4,'userId':_0x280d03[_0x5e52ce(0x300)],'username':_0x280d03[_0x5e52ce(0x2ab)],'channelName':_0x3ad655,'token':_0x3b6ca6,'userImageUrl':_0x542b55};io['to'](_0x42645d)[_0x5e52ce(0x234)](_0x5e52ce(0x1f4),_0x58d26f);}}),_0x280d03['on']('replyLiveBattleInvitation',async _0x3f7b8f=>{var _0x4c741f=_0x23e4cc,_0x23d609=_0x280d03['username'];console[_0x4c741f(0x2a1)](_0x4c741f(0x298)),console[_0x4c741f(0x2a1)](_0x3f7b8f);var _0x363a05=_0x280d03[_0x4c741f(0x300)],_0x2ee79b=_0x3f7b8f['battleId'],_0x301691=_0x3f7b8f[_0x4c741f(0x33a)],_0x2a9669=Math[_0x4c741f(0x2fa)](new Date()[_0x4c741f(0x264)]()/0x3e8),_0x508c7d=_0x4c741f(0x30a)+_0x2ee79b,_0x5f5d53=await getDbData(_0x508c7d);if(_0x5f5d53[_0x4c741f(0x342)]==0x0)return console['log'](_0x4c741f(0x326)),![];var _0x2f08f5=_0x5f5d53[0x0];if(_0x2f08f5[_0x4c741f(0x33a)]!=STATUS_LIVE_CALL_BATTLE_PENDING)return console[_0x4c741f(0x2a1)]('reply\x20battle\x20:\x20alreadyStatusUpdatedLiveBattleInvitation\x20'),_0x280d03[_0x4c741f(0x234)](_0x4c741f(0x2ed),{'battleId':_0x2ee79b}),![];var _0x10f5ec=_0x2f08f5[_0x4c741f(0x2a8)],_0x508c7d='SELECT\x20\x20*\x20from\x20user_live_history\x20where\x20id=\x20'+_0x10f5ec,_0x54a09e=await getDbData(_0x508c7d),_0x36d3e5=_0x54a09e[0x0];console[_0x4c741f(0x2a1)](_0x36d3e5);if(_0x36d3e5['status']!=STATUS_LIVE_CALL_ONGOING)return console[_0x4c741f(0x2a1)]('reply\x20battle\x20:\x20call\x20status\x20has\x20been\x20closed\x20now\x20'),![];if(_0x301691==STATUS_LIVE_CALL_BATTLE_REJECTED){var _0x508c7d=_0x4c741f(0x336)+STATUS_LIVE_CALL_BATTLE_REJECTED+'\x20where\x20id\x20=\x20'+db['escape'](_0x2ee79b),_0x2b3820=await getDbData(_0x508c7d),_0x508c7d=_0x4c741f(0x29b)+_0x36d3e5[_0x4c741f(0x221)],_0x11d878=await getDbData(_0x508c7d),_0x3f9359=_0x11d878[0x0][_0x4c741f(0x2bf)],_0x332ec4={'liveCallId':_0x10f5ec,'battleId':_0x2ee79b,'userId':_0x363a05,'username':_0x280d03[_0x4c741f(0x2ab)],'status':_0x301691};return io['to'](_0x3f9359)[_0x4c741f(0x234)](_0x4c741f(0x2f3),_0x332ec4),console[_0x4c741f(0x2a1)](_0x4c741f(0x2d7)),console[_0x4c741f(0x2a1)](_0x332ec4),![];}else{if(_0x301691==STATUS_LIVE_CALL_BATTLE_ACCEPTED){console[_0x4c741f(0x2a1)](_0x4c741f(0x2e6));var _0x508c7d=_0x4c741f(0x336)+STATUS_LIVE_CALL_BATTLE_ONGOING+',start_time='+_0x2a9669+'\x20where\x20id\x20=\x20'+db['escape'](_0x2ee79b);await getDbData(_0x508c7d);var _0x508c7d='SELECT\x20\x20*\x20from\x20user\x20where\x20id=\x20'+_0x36d3e5[_0x4c741f(0x221)],_0x11d878=await getDbData(_0x508c7d),_0x3f9359=_0x11d878[0x0]['socket_id'],_0x4990f2={'liveCallId':_0x10f5ec},_0x1b898f=await getLiveBattleInfo(_0x4990f2);io['to'](_0x10f5ec)[_0x4c741f(0x234)](_0x4c741f(0x2f3),{'liveCallId':_0x10f5ec,'battleId':_0x2ee79b,'userId':_0x363a05,'username':_0x280d03[_0x4c741f(0x2ab)],'status':STATUS_LIVE_CALL_BATTLE_ONGOING,'battleInfo':_0x1b898f}),console['log'](_0x4c741f(0x2cc)),console[_0x4c741f(0x2a1)](_0x4c741f(0x27d)),_0x280d03[_0x4c741f(0x24e)](_0x10f5ec),io['to'](_0x10f5ec)[_0x4c741f(0x234)](_0x4c741f(0x2a0),{'liveCallId':_0x10f5ec,'battleId':_0x2ee79b,'battleInfo':_0x1b898f});var _0x508c7d=_0x4c741f(0x262)+_0x363a05,_0x2351a0=await getDbData(_0x508c7d);if(_0x2351a0[_0x4c741f(0x342)]){var _0x504d5d=_0x2351a0[0x0][_0x4c741f(0x2a9)];_0x504d5d==null&&(_0x504d5d=_0x4c741f(0x255));var _0x5de7cb=STORAGE_URL+_0x4c741f(0x34b)+_0x504d5d;_0x504d5d==null&&(_0x5de7cb=null);var _0xfdfc3c=_0x36d3e5[_0x4c741f(0x325)],_0x42ab3f=_0x36d3e5[_0x4c741f(0x34d)];db[_0x4c741f(0x250)](_0x4c741f(0x207)+_0x363a05,function(_0x255ab8,_0x487d18,_0x49d745){var _0x3f18d1=_0x4c741f;_0x487d18['length']&&_0x487d18[_0x3f18d1(0x2e0)](_0x40ab05=>{var _0x19052e=_0x3f18d1,_0x47fcaf=_0x40ab05[_0x19052e(0x21f)];if(_0x47fcaf){var _0x29e663={'title':_0x23d609+_0x19052e(0x32a),'body':_0x23d609+_0x19052e(0x2f7),'notification_type':'111','liveCallId':_0x10f5ec['toString'](),'channelName':_0xfdfc3c,'token':_0x42ab3f,'userImageUrl':_0x5de7cb,'userId':_0x363a05[_0x19052e(0x291)]()};sendPushNotification(_0x47fcaf,_0x29e663);}});});}}}}),_0x280d03['on'](_0x23e4cc(0x1f2),async _0x57f9b3=>{var _0x595c62=_0x23e4cc,_0x36ccd3=_0x280d03[_0x595c62(0x2ab)];console[_0x595c62(0x2a1)](_0x595c62(0x28f));var _0x2cd8e2=_0x57f9b3['userId'],_0x50f10c=Math['round'](new Date()['getTime']()/0x3e8);db['query']('SELECT\x20\x20*\x20from\x20user_live_history\x20where\x20status=\x20'+STATUS_LIVE_CALL_ONGOING+'\x20and\x20user_id\x20='+_0x2cd8e2,async function(_0x1df850,_0x4270a1,_0x544da2){var _0x3dcd4f=_0x595c62;if(_0x4270a1['length'])console['log'](_0x3dcd4f(0x21a),_0x4270a1[0x0]['id']),_0x280d03[_0x3dcd4f(0x234)]('alreadyLiveAnotherCall',{'liveCallId':_0x4270a1[0x0]['id']});else{var _0x2fb9cc=await createToken(),_0x54517a=_0x2fb9cc[_0x3dcd4f(0x31c)],_0x1a1e83=_0x2fb9cc[_0x3dcd4f(0x34d)],_0x506cf9=_0x3dcd4f(0x1ed)+db[_0x3dcd4f(0x2d9)](_0x2cd8e2)+','+db[_0x3dcd4f(0x2d9)](_0x50f10c)+','+db[_0x3dcd4f(0x2d9)](_0x54517a)+','+db[_0x3dcd4f(0x2d9)](_0x1a1e83)+'\x20)';db['query'](_0x506cf9,function(_0x3ae67e,_0x3db87e){var _0x366bbe=_0x3dcd4f;if(_0x3ae67e)throw _0x3ae67e;var _0x15e31e=_0x3db87e[_0x366bbe(0x308)];console[_0x366bbe(0x2a1)](_0x15e31e),_0x280d03[_0x366bbe(0x24e)](_0x15e31e),_0x280d03[_0x366bbe(0x234)](_0x366bbe(0x345),{'liveCallId':_0x15e31e,'localCallId':_0x57f9b3[_0x366bbe(0x309)],'channelName':_0x54517a,'token':_0x1a1e83}),db[_0x366bbe(0x250)](_0x366bbe(0x1f7)+db[_0x366bbe(0x2d9)](_0x2cd8e2),function(_0x391859,_0x125d13,_0x467d73){var _0x243163=_0x366bbe;if(_0x125d13){if(_0x125d13[_0x243163(0x342)]){var _0x4a02d3=_0x125d13[0x0][_0x243163(0x2a9)];_0x4a02d3==null&&(_0x4a02d3='default.png');var _0x2f8dcb=STORAGE_URL+'/user/'+_0x4a02d3;_0x4a02d3==null&&(_0x2f8dcb=null),db[_0x243163(0x250)]('SELECT\x20\x20user.id,user.username,user.socket_id,user.device_token\x20FROM\x20follower\x20left\x20join\x20user\x20on\x20follower.follower_id\x20=\x20user.id\x20where\x20follower.user_id\x20='+_0x2cd8e2,function(_0xafe4f0,_0x54caee,_0x44d98b){var _0x33a655=_0x243163;_0x54caee[_0x33a655(0x342)]&&_0x54caee[_0x33a655(0x2e0)](_0x5e4512=>{var _0x5da113=_0x33a655,_0xbeeb3b=_0x5e4512[_0x5da113(0x21f)];if(_0xbeeb3b){var _0x5f03d1={'title':_0x36ccd3+_0x5da113(0x1fd),'body':_0x36ccd3+_0x5da113(0x268),'notification_type':'101','liveCallId':_0x15e31e[_0x5da113(0x291)](),'channelName':_0x54517a,'token':_0x1a1e83,'userImageUrl':_0x2f8dcb,'userId':_0x2cd8e2[_0x5da113(0x291)]()};sendPushNotification(_0xbeeb3b,_0x5f03d1);}});});}}});});}});}),_0x280d03['on'](_0x23e4cc(0x295),_0x4f8cb3=>{var _0xa693dc=_0x23e4cc;console[_0xa693dc(0x2a1)](_0xa693dc(0x324));var _0x38524a=_0x4f8cb3[_0xa693dc(0x300)],_0x4177e2={'userId':_0x38524a};endLiveCallIfExist(_0x280d03,_0x4177e2);}),_0x280d03['on'](_0x23e4cc(0x344),_0x58a9ff=>{var _0x49d4ac=_0x23e4cc;console[_0x49d4ac(0x2a1)](_0x49d4ac(0x1ef));var _0x8bb0c2=_0x58a9ff[_0x49d4ac(0x300)],_0x3630f4=_0x58a9ff[_0x49d4ac(0x2a7)];_0x280d03['to'](_0x3630f4)[_0x49d4ac(0x234)](_0x49d4ac(0x344),{'username':_0x280d03[_0x49d4ac(0x2ab)],'userId':_0x280d03[_0x49d4ac(0x300)],'liveCallId':_0x3630f4}),_0x280d03[_0x49d4ac(0x25f)](_0x3630f4);var _0x4f3e51='delete\x20from\x20live_tv_viewer\x20\x20where\x20\x20live_call_id\x20='+db[_0x49d4ac(0x2d9)](_0x3630f4)+'\x20and\x20\x20user_id\x20=\x20'+db[_0x49d4ac(0x2d9)](_0x8bb0c2);db[_0x49d4ac(0x250)](_0x4f3e51,function(_0x199b73,_0x61e168,_0x2573c7){});}),_0x280d03['on']('addUserLiveCall',async _0x2bcdf9=>{var _0x5cba81=_0x23e4cc;console[_0x5cba81(0x2a1)](_0x5cba81(0x20b));var _0x200876=_0x2bcdf9['userId'],_0x3d3ebb=_0x2bcdf9['liveCallId'];_0x280d03[_0x5cba81(0x24e)](_0x3d3ebb),_0x280d03['to'](_0x3d3ebb)[_0x5cba81(0x234)](_0x5cba81(0x348),{'username':_0x280d03['username'],'userId':_0x280d03[_0x5cba81(0x300)],'liveCallId':_0x3d3ebb});var _0x21ef12={'liveCallId':_0x3d3ebb},_0x76b3e1=await getLiveBattleInfo(_0x21ef12);_0x76b3e1[_0x5cba81(0x227)][_0x5cba81(0x342)]>0x0&&_0x280d03[_0x5cba81(0x234)](_0x5cba81(0x2a0),{'liveCallId':_0x3d3ebb,'battleInfo':_0x76b3e1});var _0x301556=Math[_0x5cba81(0x2fa)](new Date()[_0x5cba81(0x264)]()/0x3e8);db[_0x5cba81(0x250)](_0x5cba81(0x319)+db[_0x5cba81(0x2d9)](_0x3d3ebb)+_0x5cba81(0x239)+db['escape'](_0x200876),function(_0x43244a,_0x39108c,_0x54d303){var _0xcf6a67=_0x5cba81;if(_0x39108c[0x0]['total']==0x0){var _0x2e1a30='INSERT\x20INTO\x20live_call_viewer\x20(user_id,\x20live_call_id,created_at)\x20VALUES\x20('+db[_0xcf6a67(0x2d9)](_0x200876)+','+db[_0xcf6a67(0x2d9)](_0x3d3ebb)+','+db[_0xcf6a67(0x2d9)](_0x301556)+'\x20)';db[_0xcf6a67(0x250)](_0x2e1a30,function(_0x1d26e1,_0x5b3408){if(_0x1d26e1)throw _0x1d26e1;});}});}),_0x280d03['on'](_0x23e4cc(0x270),_0x343b8b=>{var _0x55aba8=_0x23e4cc;_0x343b8b[_0x55aba8(0x2ab)]=_0x280d03[_0x55aba8(0x2ab)],_0x343b8b[_0x55aba8(0x2cf)]=Math[_0x55aba8(0x2fa)](new Date()[_0x55aba8(0x264)]()/0x3e8),_0x343b8b[_0x55aba8(0x2c6)]=_0x343b8b[_0x55aba8(0x300)];var _0x18a966=_0x343b8b[_0x55aba8(0x2a7)];_0x280d03['to'](_0x18a966)[_0x55aba8(0x234)](_0x55aba8(0x270),_0x343b8b),_0x280d03[_0x55aba8(0x234)](_0x55aba8(0x26e),{'current_status':0x1,'localMessageId':_0x343b8b[_0x55aba8(0x260)],'liveCallId':_0x18a966,'created_at':_0x343b8b[_0x55aba8(0x2cf)]});}),_0x280d03['on']('endLiveBattle',async _0x1f3fb3=>{var _0x47e2a9=_0x23e4cc;console[_0x47e2a9(0x2a1)](_0x47e2a9(0x34e));var _0x85146d=_0x1f3fb3['battleId'],_0x4934db=Math[_0x47e2a9(0x2fa)](new Date()['getTime']()/0x3e8),_0x30ea6c=_0x47e2a9(0x217)+_0x85146d,_0x3b2c23=await getDbData(_0x30ea6c);if(_0x3b2c23['length']==0x0)return console['log'](_0x47e2a9(0x2f0)),![];var _0x504485=_0x3b2c23[0x0],_0x85146d=_0x504485['id'],_0xf23cf2=_0x504485[_0x47e2a9(0x237)],_0x433884=_0x4934db-_0xf23cf2,_0x4a26a0=_0x504485[_0x47e2a9(0x2a8)],_0x16eef4=_0x47e2a9(0x336)+STATUS_LIVE_CALL_BATTLE_COMPLETED+_0x47e2a9(0x2d0)+db[_0x47e2a9(0x2d9)](_0x4934db)+'\x20,\x20total_time\x20=\x20'+db[_0x47e2a9(0x2d9)](_0x433884)+_0x47e2a9(0x284)+db[_0x47e2a9(0x2d9)](_0x85146d);getDbData(_0x16eef4),io['to'](_0x4a26a0)[_0x47e2a9(0x234)]('endLiveBattle',{'username':_0x280d03[_0x47e2a9(0x2ab)],'userId':_0x280d03[_0x47e2a9(0x300)],'liveCallId':_0x4a26a0,'battleId':_0x85146d});}),_0x280d03['on'](_0x23e4cc(0x26b),async _0x488c5c=>{var _0x515f00=_0x23e4cc;console['log'](_0x515f00(0x267));var _0x43ebf9=_0x280d03['userId'],_0x3475df=_0x488c5c[_0x515f00(0x300)],_0x47fc95=_0x488c5c[_0x515f00(0x2a7)],_0x42bd30=_0x488c5c[_0x515f00(0x321)],_0x118eaf=_0x488c5c['giftId'],_0x1cd33c=Math[_0x515f00(0x2fa)](new Date()[_0x515f00(0x264)]()/0x3e8),_0x5d714a=_0x515f00(0x2af)+_0x118eaf,_0x27d849=await getDbData(_0x5d714a);if(_0x27d849['length']==0x0)return console[_0x515f00(0x2a1)]('No\x20gift\x20record\x20available'),![];var _0x6467b1=_0x27d849[0x0],_0x50e8d7=_0x6467b1[_0x515f00(0x30d)],_0x51a18b=_0x6467b1['is_paid'],_0x5d714a=_0x515f00(0x1f1)+_0x43ebf9,_0x575680=await getDbData(_0x5d714a),_0x236941=_0x575680[0x0],_0x4e3d43=_0x236941[_0x515f00(0x2c2)];_0x50e8d7>_0x4e3d43&&_0x280d03[_0x515f00(0x234)](_0x515f00(0x257),{'availableCoin':_0x4e3d43,'gitCoin':_0x50e8d7});var _0x5d714a=_0x515f00(0x2de),_0xb9d341=await getDbData(_0x5d714a),_0x4c1b00=_0xb9d341[0x0],_0x58a1a0=_0x4c1b00['available_coin'],_0x485053=_0x4c1b00[_0x515f00(0x2a6)],_0x1a3af2=0x0;_0x485053>0x0&&(_0x1a3af2=_0x50e8d7/0x64*_0x485053);var _0x1efee0=_0x50e8d7-_0x1a3af2,_0x5d714a;_0x42bd30>0x0?_0x5d714a='INSERT\x20INTO\x20gift_history\x20(sender_id,reciever_id,gift_id,coin,coin_actual,\x20send_on_type,\x20live_call_id,battle_id,created_at)\x20VALUES\x20('+db[_0x515f00(0x2d9)](_0x43ebf9)+','+db['escape'](_0x3475df)+','+db[_0x515f00(0x2d9)](_0x118eaf)+','+db[_0x515f00(0x2d9)](_0x1efee0)+','+db[_0x515f00(0x2d9)](_0x50e8d7)+','+db['escape'](0x1)+','+db[_0x515f00(0x2d9)](_0x47fc95)+','+db[_0x515f00(0x2d9)](_0x42bd30)+','+db['escape'](_0x1cd33c)+'\x20)':_0x5d714a='INSERT\x20INTO\x20gift_history\x20(sender_id,reciever_id,gift_id,coin,coin_actual,send_on_type,\x20live_call_id,created_at)\x20VALUES\x20('+db[_0x515f00(0x2d9)](_0x43ebf9)+','+db[_0x515f00(0x2d9)](_0x3475df)+','+db[_0x515f00(0x2d9)](_0x118eaf)+','+db['escape'](_0x1efee0)+','+db[_0x515f00(0x2d9)](_0x50e8d7)+','+db['escape'](0x1)+','+db[_0x515f00(0x2d9)](_0x47fc95)+','+db[_0x515f00(0x2d9)](_0x1cd33c)+'\x20)';var _0x562678=await getDbData(_0x5d714a),_0x35799c=_0x562678[_0x515f00(0x308)];if(_0x51a18b==0x1){if(_0x35799c){var _0x3f833e=_0x4e3d43-_0x50e8d7,_0x5d714a='update\x20user\x20set\x20available_coin='+_0x3f833e+_0x515f00(0x284)+_0x43ebf9,_0x33f779=await getDbData(_0x5d714a);if(_0x33f779){var _0x272fb0=0x2,_0x28a840=0x2,_0x296350=0x6,_0x42256f=0x3,_0x5d714a='INSERT\x20INTO\x20payment\x20(type,\x20user_id,\x20transaction_type,\x20payment_type,\x20payment_mode,\x20coin,\x20gift_history_id,created_at)\x20VALUES\x20('+db[_0x515f00(0x2d9)](_0x272fb0)+','+db['escape'](_0x43ebf9)+','+db['escape'](_0x28a840)+','+db[_0x515f00(0x2d9)](_0x296350)+','+db[_0x515f00(0x2d9)](_0x42256f)+','+db['escape'](_0x50e8d7)+','+db['escape'](_0x35799c)+','+db[_0x515f00(0x2d9)](_0x1cd33c)+'\x20)',_0x562678=await getDbData(_0x5d714a),_0x5d714a='SELECT\x20\x20user.id,user.username,user.socket_id,available_coin\x20from\x20user\x20where\x20id=\x20'+_0x3475df,_0x963f82=await getDbData(_0x5d714a),_0x5d7de9=_0x963f82[0x0],_0x4e3d43=_0x5d7de9[_0x515f00(0x2c2)],_0x3f833e=_0x4e3d43+_0x1efee0,_0x5d714a=_0x515f00(0x32c)+_0x3f833e+'\x20where\x20id\x20=\x20'+_0x3475df,_0x33f779=await getDbData(_0x5d714a),_0x272fb0=0x2,_0x28a840=0x1,_0x296350=0x6,_0x42256f=0x3,_0x5d714a=_0x515f00(0x273)+db[_0x515f00(0x2d9)](_0x272fb0)+','+db[_0x515f00(0x2d9)](_0x3475df)+','+db['escape'](_0x28a840)+','+db[_0x515f00(0x2d9)](_0x296350)+','+db[_0x515f00(0x2d9)](_0x42256f)+','+db[_0x515f00(0x2d9)](_0x1efee0)+','+db[_0x515f00(0x2d9)](_0x35799c)+','+db[_0x515f00(0x2d9)](_0x1cd33c)+'\x20)',_0x562678=await getDbData(_0x5d714a);if(_0x1a3af2>0x0)var _0x2867f1=_0x58a1a0+_0x1a3af2,_0x5d714a=_0x515f00(0x2d1)+_0x2867f1+_0x515f00(0x259),_0x132cdc=await getDbData(_0x5d714a),_0x52690e=0x1,_0x272fb0=0x2,_0x28a840=0x1,_0x296350=0xd,_0x42256f=0x3,_0x5d714a=_0x515f00(0x273)+db[_0x515f00(0x2d9)](_0x272fb0)+','+db['escape'](_0x52690e)+','+db['escape'](_0x28a840)+','+db['escape'](_0x296350)+','+db[_0x515f00(0x2d9)](_0x42256f)+','+db[_0x515f00(0x2d9)](_0x1a3af2)+','+db['escape'](_0x35799c)+','+db[_0x515f00(0x2d9)](_0x1cd33c)+'\x20)',_0x562678=await getDbData(_0x5d714a);}}}var _0x364ca6={'liveCallId':_0x47fc95,'battleId':_0x42bd30},_0x3d39a4=await getLiveBattleInfo(_0x364ca6),_0x12bf44=STORAGE_URL+'/gift/'+_0x6467b1['image'],_0x30be09=STORAGE_URL+_0x515f00(0x34b)+_0x236941[_0x515f00(0x2a9)];_0x12bf44==null&&(_0x30be09=null),_0x488c5c[_0x515f00(0x2ca)]=_0x12bf44,_0x488c5c[_0x515f00(0x303)]=_0x6467b1['name'],_0x488c5c['coin']=_0x6467b1[_0x515f00(0x30d)],_0x488c5c[_0x515f00(0x1fe)]=_0x3d39a4,_0x488c5c[_0x515f00(0x202)]=_0x43ebf9,_0x488c5c[_0x515f00(0x28d)]=_0x236941[_0x515f00(0x2ab)],_0x488c5c['senderImageUrl']=_0x30be09,io['to'](_0x47fc95)[_0x515f00(0x234)](_0x515f00(0x226),_0x488c5c);}),_0x280d03['on'](_0x23e4cc(0x21d),_0xd312d1=>{var _0x26116b=_0x23e4cc;console[_0x26116b(0x2a1)](_0x26116b(0x2d4));var _0x3c78b8=_0xd312d1[_0x26116b(0x300)],_0x2b64f8=_0xd312d1[_0x26116b(0x283)];_0x280d03['join'](_0x2b64f8),_0x280d03['to'](_0x2b64f8)[_0x26116b(0x234)]('addUserLiveTv',{'username':_0x280d03[_0x26116b(0x2ab)],'userId':_0x280d03[_0x26116b(0x300)],'liveTvId':_0x2b64f8});const _0x277865=_0x2b64f8[_0x26116b(0x1ec)]('_');let _0x1684a6=_0x277865[0x1];var _0x53d1cb=Math[_0x26116b(0x2fa)](new Date()['getTime']()/0x3e8);db['query']('SELECT\x20count(id)\x20as\x20total\x20FROM\x20live_tv_viewer\x20where\x20\x20\x20live_tv_id\x20='+db[_0x26116b(0x2d9)](_0x1684a6)+_0x26116b(0x239)+db['escape'](_0x3c78b8),function(_0x39e9eb,_0x5e0630,_0x567731){var _0x15b8fe=_0x26116b;if(_0x5e0630[0x0][_0x15b8fe(0x30e)]==0x0){var _0x3ba6ee=_0x15b8fe(0x228)+db['escape'](_0x3c78b8)+','+db[_0x15b8fe(0x2d9)](_0x1684a6)+','+db[_0x15b8fe(0x2d9)](_0x53d1cb)+'\x20)';db[_0x15b8fe(0x250)](_0x3ba6ee,function(_0x1f1028,_0x35ec12){if(_0x1f1028)throw _0x1f1028;});}});}),_0x280d03['on']('leaveUserLiveTv',_0xe20566=>{var _0x33d138=_0x23e4cc;console[_0x33d138(0x2a1)]('leave\x20live\x20Tv');var _0x59cb22=_0xe20566['userId'],_0x51a8f6=_0xe20566[_0x33d138(0x283)];_0x280d03['to'](_0x51a8f6)[_0x33d138(0x234)](_0x33d138(0x287),{'username':_0x280d03[_0x33d138(0x2ab)],'userId':_0x280d03['userId'],'liveTvId':_0x51a8f6}),_0x280d03[_0x33d138(0x25f)](_0x51a8f6);}),_0x280d03['on'](_0x23e4cc(0x22b),_0xbc963a=>{var _0x2c6c65=_0x23e4cc;_0xbc963a[_0x2c6c65(0x2ab)]=_0x280d03[_0x2c6c65(0x2ab)],_0xbc963a['created_at']=Math[_0x2c6c65(0x2fa)](new Date()[_0x2c6c65(0x264)]()/0x3e8),_0xbc963a[_0x2c6c65(0x2c6)]=_0xbc963a['userId'];var _0x1cf4d9=_0xbc963a[_0x2c6c65(0x283)];_0x280d03['to'](_0x1cf4d9)[_0x2c6c65(0x234)]('sendMessageLiveTv',_0xbc963a),_0x280d03['emit'](_0x2c6c65(0x240),{'current_status':0x1,'localMessageId':_0xbc963a[_0x2c6c65(0x260)],'liveTvId':_0x1cf4d9,'created_at':_0xbc963a[_0x2c6c65(0x2cf)]});}),_0x280d03['on'](_0x23e4cc(0x347),_0xd3fa62=>{var _0xe5543b=_0x23e4cc;console[_0xe5543b(0x2a1)](_0xe5543b(0x331));const _0x37d4a1=_0xe5543b(0x22e),_0xffbb46={'data':{'score':'8520','time':_0xe5543b(0x327)},'token':_0x37d4a1};admin['messaging']()[_0xe5543b(0x28b)](_0xffbb46)[_0xe5543b(0x301)](_0x56ee6a=>{var _0x2d65c2=_0xe5543b;console['log'](_0x2d65c2(0x290),_0x56ee6a);})[_0xe5543b(0x330)](_0x36cd01=>{var _0x456fac=_0xe5543b;console[_0x456fac(0x2a1)]('Error\x20sending\x20message:',_0x36cd01);});});});function getMessageBody(_0x3037e9){var _0x2bccc1=_0x29d80a,_0x2f47e8={},_0x4f39ab='';_0x2f47e8[_0x2bccc1(0x223)]='',_0x2f47e8[_0x2bccc1(0x2a9)]='';var _0xff57c1=doDecrypt(_0x3037e9[_0x2bccc1(0x220)]);console[_0x2bccc1(0x2a1)](_0xff57c1);var _0x4e5cd5=_0xff57c1[_0x2bccc1(0x24a)];if(_0x4e5cd5==0x1)_0x2f47e8[_0x2bccc1(0x223)]=doDecrypt(_0xff57c1[_0x2bccc1(0x26d)]);else{if(_0x4e5cd5==0x2)_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x2ae);else{if(_0x4e5cd5==0x3)_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x34c);else{if(_0x4e5cd5==0x4)_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x25a);else{if(_0x4e5cd5==0x5)_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x243);else{if(_0x4e5cd5==0x6)_0x2f47e8[_0x2bccc1(0x223)]='Sent\x20a\x20stiker';else{if(_0x4e5cd5==0x7)_0x2f47e8['messageString']=_0x2bccc1(0x2ff);else{if(_0x4e5cd5==0x8)_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x2c5);else{if(_0x4e5cd5==0xa)_0x2f47e8['messageString']=_0x2bccc1(0x2f5);else{if(_0x4e5cd5==0xb)_0x2f47e8['messageString']=_0x2bccc1(0x292);else{if(_0x4e5cd5==0xc)_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x276);else{if(_0x4e5cd5==0xd)_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x28c);else{if(_0x4e5cd5==0xe)_0x2f47e8['messageString']=_0x2bccc1(0x349);else{if(_0x4e5cd5==0xf)_0x2f47e8['messageString']=_0x2bccc1(0x23c);else{if(_0x4e5cd5==0x10)_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x1fc);else{if(_0x4e5cd5==0x14)_0x2f47e8['messageString']=_0x2bccc1(0x338);else{if(_0x4e5cd5==0x64)_0x2f47e8[_0x2bccc1(0x223)]='Group\x20action';else _0x4e5cd5==0xc8?_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x2b1):_0x2f47e8[_0x2bccc1(0x223)]=_0x2bccc1(0x232);}}}}}}}}}}}}}}}}return _0x2f47e8;}function sendPushNotification(_0x29d2b4,_0x196d79){var _0x15b42a=_0x29d80a;_0x196d79[_0x15b42a(0x215)]==null&&(_0x196d79[_0x15b42a(0x215)]='');_0x196d79[_0x15b42a(0x1ee)]==null&&(_0x196d79[_0x15b42a(0x1ee)]='');_0x196d79['sound']=_0x15b42a(0x333),_0x196d79[_0x15b42a(0x2b2)]=_0x15b42a(0x210),_0x196d79[_0x15b42a(0x252)]=_0x15b42a(0x2b7),console[_0x15b42a(0x2a1)](_0x196d79[_0x15b42a(0x23b)]);var _0x3be46c=_0x196d79[_0x15b42a(0x23b)];_0x3be46c=_0x3be46c[_0x15b42a(0x291)]();_0x3be46c[_0x15b42a(0x342)]>0x64&&(_0x3be46c=_0x3be46c[_0x15b42a(0x2d8)](0x0,0x64));_0x196d79[_0x15b42a(0x23b)]=_0x3be46c;var _0x1f531e={'notification':{'title':_0x196d79['title'],'body':_0x3be46c},'data':_0x196d79,'token':_0x29d2b4};console[_0x15b42a(0x2a1)](_0x1f531e),admin[_0x15b42a(0x21c)]()[_0x15b42a(0x28b)](_0x1f531e)[_0x15b42a(0x301)](_0xccda5f=>{var _0x3d2fa4=_0x15b42a;console['log'](_0x3d2fa4(0x290),_0xccda5f);})[_0x15b42a(0x330)](_0x1927b9=>{var _0x36423b=_0x15b42a;console[_0x36423b(0x2a1)](_0x36423b(0x329),_0x1927b9);});}function sendIosVoipPushNotification(_0x5fabf,_0x319fdc){var _0x14d7a2=_0x29d80a,_0x1854d9={'token':{'key':config[_0x14d7a2(0x2b0)][_0x14d7a2(0x236)],'keyId':config['voipNotification']['keyId'],'teamId':config[_0x14d7a2(0x2b0)]['teamId']},'production':config['voipNotification'][_0x14d7a2(0x213)]},_0x5861e3=new apn[(_0x14d7a2(0x2bd))](_0x1854d9),_0x75b9f6=new apn['Notification']();_0x75b9f6[_0x14d7a2(0x339)]=Math['floor'](Date[_0x14d7a2(0x20c)]()/0x3e8)+0x3c,_0x75b9f6[_0x14d7a2(0x305)]=0x1,_0x75b9f6['sound']=_0x14d7a2(0x2ac),_0x75b9f6[_0x14d7a2(0x1f9)]=_0x14d7a2(0x27e),_0x75b9f6['payload']=_0x319fdc,_0x75b9f6['topic']=config[_0x14d7a2(0x2b0)]['bundleId']+'.voip',_0x5861e3[_0x14d7a2(0x28b)](_0x75b9f6,_0x5fabf)[_0x14d7a2(0x301)]((_0x38e747,_0x573559)=>{var _0xbaf1b2=_0x14d7a2;console[_0xbaf1b2(0x2a1)](_0x573559),_0x38e747?console[_0xbaf1b2(0x2a1)](JSON[_0xbaf1b2(0x261)](_0x38e747)):console[_0xbaf1b2(0x2a1)](JSON[_0xbaf1b2(0x261)](_0x573559));});}async function createToken(){var _0x5bb85c=_0x29d80a;let _0x1013eb=_0x5bb85c(0x2de);var _0xd563fb=await getDbData(_0x1013eb),_0x257399=uuidv4();const _0x342964=_0xd563fb[0x0]['agora_api_key'],_0xc0089e=_0xd563fb[0x0]['agora_app_certificate'],_0x3036b7=0x0,_0x1df7b8='0',_0x252e72=RtcRole[_0x5bb85c(0x29a)],_0x25aeeb=0xe10,_0x40e14d=Math[_0x5bb85c(0x1f8)](Date[_0x5bb85c(0x20c)]()/0x3e8),_0x58fbb0=_0x40e14d+_0x25aeeb,_0x1f1825=RtcTokenBuilder[_0x5bb85c(0x33e)](_0x342964,_0xc0089e,_0x257399,_0x3036b7,_0x252e72,_0x58fbb0);return{'channelName':_0x257399,'token':_0x1f1825};}function doEncrypt(_0x3e2a01){var _0xb644=_0x29d80a;typeof _0x3e2a01==_0xb644(0x288)&&(_0x3e2a01=JSON[_0xb644(0x261)](_0x3e2a01));var _0x68ce47=config['encryptionKey'],_0x20665=crypto[_0xb644(0x2cd)][_0xb644(0x294)](_0x3e2a01,_0x68ce47)[_0xb644(0x291)]();return _0x20665;}function _0x115e(){var _0x1839dd=['connection','seeen\x20message\x20sento\x20to','Sent\x20a\x20story','room','/voiptest','user\x20disconnected','callType','password','\x27\x20\x20where\x20id\x20=\x20','accepted\x20and\x20ongoing\x20notitifcation','New\x20call','mysql2','SELECT\x20user.id,user.username,user.image\x20from\x20user\x20where\x20user.id\x20=','listening\x20on\x20*:','reciever\x20socket\x20connected','liveTvId','\x20where\x20id\x20=\x20','100','delete\x20message','leaveUserLiveTv','object','indexOf','\x20and\x20chat_message_user.is_user_notify=','send','Sent\x20a\x20drawing','senderName','./config.json','go\x20live\x20room\x20created','Successfully\x20sent\x20message:','toString','Sent\x20a\x20\x20post','\x20and\x20host_user_id\x20=','encrypt','endLiveCall','device_token_voip_ios','encryptionKey','reply\x20of\x20invitation\x20for\x20live\x20battle','4902ABlVLG','PUBLISHER','SELECT\x20\x20user.id,user.username,user.socket_id\x20from\x20user\x20where\x20id=\x20','\x27\x20where\x20user_id\x20=\x20','sslCertificatePath','updateMessageCurrentStatus','101','liveBattleHostUpdated','log','\x20where\x20uuid\x20=\x20','type','totalAllowedTime','sockets','commission_on_gift','liveCallId','user_live_history_id','image','timeToEnd','username','ping.aiff','_keyStr','Sent\x20an\x20image','SELECT\x20\x20*\x20from\x20gift\x20\x20where\x20id=\x20','voipNotification','Send\x20a\x20gift','content_available','SELECT\x20*\x20FROM\x20chat_message\x20where\x20\x20id\x20=','initializeApp','./serviceAccountKey.json','total_coin','high','UserLogin','update\x20user\x20set\x20socket_id=\x27','socket.io','A\x20user\x20connected\x20:\x20','replied_on_message','Provider','error','socket_id','inviteUserInLiveBattleConfirm','SELECT\x20\x20*\x20from\x20user_live_battle\x20where\x20status=\x20','available_coin','\x20,\x20end_time\x20=\x20','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=','Shared\x20the\x20location','created_by','chat_message_id','alreadyLiveAnotherCall\x20battle','\x27\x20where\x20id\x20=','giftUrl','sendFile','reply\x20battle\x20:\x20liveBattleInvitationUpated','AES','removeRoomAdmin','created_at',',\x20end_time\x20=\x20','update\x20setting\x20set\x20available_coin=','\x20and\x20chat_message.status\x20<>','SELECT\x20*\x20FROM\x20chat_room\x20where\x20id\x20=\x20','user\x20added\x20in\x20live\x20tv','\x20and\x20super_host_user_id\x20=','\x20and\x20status\x20=10','rejected\x20notitifcation','substring','escape','update\x20user\x20set\x20socket_id=NULL,chat_last_time_online=\x27','user','get','replyCode','SELECT\x20*\x20FROM\x20setting','super_host_user_id','forEach','\x27,chat_last_time_online=\x27','total_gift','SELECT\x20id,username,socket_id,device_type,device_token,device_token_voip_ios\x20FROM\x20user\x20where\x20id\x20=','10227888whpvhA','createConnection','reply\x20battle\x20:\x20accepted\x20call\x20','103','SELECT\x20user.id,user.username,\x20user.image\x20from\x20user\x20where\x20user.id\x20=','makeRoomAdmin','SELECT\x20chat_message_user.id\x20as\x20chat_message_user_id,\x20chat_message_user.user_id,chat_message_user.chat_message_id,chat_message_user.status,\x20chat_message.local_message_id,\x20chat_message.room_id\x20FROM\x20chat_message_user\x20left\x20join\x20chat_message\x20on\x20chat_message.id\x20=\x20chat_message_user.chat_message_id\x20where\x20chat_message.created_by\x20=\x20','close','hostname','alreadyStatusUpdatedLiveBattleInvitation','SELECT\x20sum(coin)\x20as\x20total_coin,\x20count(id)\x20as\x20total_gift\x20from\x20gift_history\x20where\x20gift_history.reciever_id\x20=','\x20and\x20room_id\x20=','No\x20battle\x20found','userOffline','leftRoom','liveBattleInvitationUpated','update\x20chat_message\x20set\x20status=\x27','forword\x20the\x20message','SELECT\x20\x20user_live_battle.id\x20,\x20user_live_battle.super_host_user_id\x20,\x20user_live_battle.host_user_id,start_time,end_time,total_time,total_allowed_time\x20from\x20user_live_battle\x20\x20where\x20user_live_battle.status=\x20','\x20is\x20live\x20now\x20in\x20battle','update\x20chat_room_user\x20set\x20status=\x2710\x27\x20where\x20id\x20=','SELECT\x20*\x20FROM\x20call_detail\x20where\x20\x20\x20uuid\x20=','round','.voip','performActionOnCall','Invite\x20for\x20live\x20battle','callStatusUpdate','Shared\x20the\x20contact','userId','then','databaseURL','name','\x20,\x20total_time\x20=\x20','badge','express','host_user_id','insertId','localCallId','SELECT\x20\x20*\x20from\x20user_live_battle\x20where\x20id=\x20','\x20and\x20gift_history.battle_id\x20=','device_type','coin','total','crypto-js','addUser','callCreateConfirm','disconnect\x20fire','removeAllListeners','listen','sound','cert','\x20and\x20\x20user_id\x20=','baljit','SELECT\x20count(id)\x20as\x20total\x20FROM\x20live_call_viewer\x20where\x20\x20\x20live_call_id\x20=','updateChatAccessGroup','sendMessage','channelName','5CZvWwN','storageUrl','fromCharCode','is_encrypted','battleId','INSERT\x20INTO\x20user_live_battle\x20(user_live_history_id,super_host_user_id,host_user_id,\x20total_allowed_time,created_at,status)\x20VALUES\x20(','sender_socket_id','end\x20\x20live\x20call','channel_name','no\x20resultsLiveCall\x20Battle\x20','2:43','http','Error\x20sending\x20message:','\x20is\x20live\x20in\x20battle','alreadyInviteUserInLiveBattleSent\x20and\x20cancelled\x20the\x20old\x20one\x20request','update\x20user\x20set\x20available_coin=','update\x20chat_room_user\x20set\x20is_admin=1\x20where\x20user_id\x20=\x20','deleteScope','apn','catch','typing','firebase-admin','default','push','chat_message_user_id','update\x20user_live_battle\x20set\x20status=','port','Reacted\x20on\x20your\x20message','expiry','status','INSERT\x20INTO\x20chat_message\x20(local_message_id,room_id,\x20type,\x20message,\x20replied_on_message,\x20is_encrypted,\x20chat_version,\x20created_by,\x20created_at,delete_time)\x20VALUES\x20(','reciever\x20socket\x20not\x20\x20connected\x20and\x20send\x20push\x20notification','update\x20call_detail\x20set\x20status=','buildTokenWithUid','createServer','user_p_id','update\x20chat_room\x20set\x20chat_access_group=','length','1241656fkQOtS','leaveUserLiveCall','goLiveConfirm','total_allowed_time','sendNotificationTest','addUserLiveCall','Sent\x20a\x20profile','dev','/user/','Sent\x20a\x20video','token','end\x20live\x20battle','692144hcboVd','payload','split','INSERT\x20INTO\x20user_live_history\x20(user_id,\x20start_time,channel_name,token)\x20VALUES\x20(','userImage','leave\x20live\x20call','warn','SELECT\x20\x20user.id,user.username,user.socket_id,available_coin,\x20user.image\x20from\x20user\x20where\x20id=\x20','goLive_OLD','charCodeAt','newliveBattleInvitation','data','update\x20chat_message_user\x20set\x20status=\x27','SELECT\x20*\x20FROM\x20user\x20where\x20\x20\x20id\x20=','floor','alert','bundleId','title','Sent\x20a\x20file','\x20is\x20live','battleInfo','replace','\x27\x20where\x20chat_message_id\x20=\x20','user\x20disconnected\x20errrRRR','senderId','63EpSpcU','\x20and\x20room_id\x20=\x20','_utf8_encode','uuid','SELECT\x20\x20user.id,user.username,user.socket_id,user.device_token\x20FROM\x20follower\x20left\x20join\x20user\x20on\x20follower.follower_id\x20=\x20user.id\x20where\x20follower.user_id\x20=','SELECT\x20\x20*\x20from\x20user_live_history\x20where\x20status=\x20','SELECT\x20*\x20FROM\x20chat_room_user\x20where\x20user_id\x20=','delete\x20from\x20live_call_viewer\x20\x20where\x20user_id\x20=\x20','user\x20added\x20in\x20live\x20call','now','warning','\x20and\x20user_live_battle.user_live_history_id\x20=','dbConnected','true','host','read\x20message','production','alreadyLiveAnotherCall','userImageUrl','go\x20live\x20room\x20created\x20request','SELECT\x20\x20*\x20from\x20user_live_battle\x20\x20where\x20id=\x20','end','SELECT\x20id,username,socket_id\x20FROM\x20user\x20where\x20id\x20=','already\x20live\x20call\x20id\x20','notification_type','messaging','addUserLiveTv','receiver_id','device_token','message','user_id','9309520vFeGqL','messageString','site_url','sdjfsjhflkasjfsdfkjsdftokenA','newGiftReceivedliveCall','liveBattleHosts','INSERT\x20INTO\x20live_tv_viewer\x20(user_id,\x20live_tv_id,created_at)\x20VALUES\x20(','Notification','New\x20Call','sendMessageLiveTv','200','SELECT\x20id,username,socket_id\x20FROM\x20user\x20where\x20id\x20IN(','eUzWru_LqrDO28TPywKTj5:APA91bFKpKN6qy6q3IXgO8Mkxy7bf22CrUO7mqyddT_MwKXLw4YHkaGrxkU03e1suVMwSGlV4cn9ek8ziM7Y1Rkv-lz3x5ZymzbLg6FsbgAuSRvPOJGsnh9TEKWSVTQ-ZY8pOVqSHAl4','chat_version','totalOngoingTime','readMessage','Sent\x20a\x20message','parse','emit','userOnline','key','start_time','INSERT\x20INTO\x20chat_room_user\x20(room_id,\x20user_id,is_admin,created_at,created_by)\x20VALUES\x20(','\x20and\x20user_id\x20=','update\x20chat_room_user\x20set\x20status=\x27','body','Sent\x20a\x20group','local_message_id','deleteMessage','NOTUP','updateMessageStatusLiveTv','deleteAfter','disconnect','Sent\x20a\x20gif\x20file','\x27,is_chat_user_online=\x27','SELECT\x20\x20*\x20from\x20user_live_battle\x20where\x20user_live_history_id=\x20','charAt','\x20and\x20user_id\x20=\x20','&site_url=','\x27\x20where\x20chat_message_id\x20=','messageType','decode','SELECT\x20\x20chat_room.type,chat_room_user.id,chat_room_user.status,chat_room_user.user_id,user.device_token,user.socket_id\x20FROM\x20chat_room_user\x20left\x20join\x20user\x20on\x20chat_room_user.user_id\x20=\x20user.id\x20left\x20join\x20chat_room\x20on\x20chat_room_user.room_id=chat_room.id\x20\x20where\x20chat_room_user.room_id\x20=','chatAccessGroup','join','credential','query','SELECT\x20id,username,socket_id,device_token_voip_ios,device_token,device_type\x20FROM\x20user\x20where\x20id\x20=','priority','stack','decrypt','default.png','removeUserFromRoom','notEnoughBalanceLiveCallGift','room_id','\x20where\x20id\x20=\x201','Sent\x20and\x20audio','\x20where\x20\x20id\x20=\x20','Utf8','SELECT\x20*\x20FROM\x20user\x20where\x20\x20id\x20=','SELECT\x20*\x20FROM\x20user_live_history\x20where\x20\x20\x20id\x20=','leave','localMessageId','stringify','SELECT\x20\x20*\x20from\x20user\x20where\x20id=\x20','battleDetail','getTime','INSERT\x20INTO\x20call_detail\x20(uuid,local_call_id,call_type,\x20caller_id,\x20receiver_id,\x20start_time,\x20channel_name)\x20VALUES\x20(','enc','send\x20gift\x20to\x20live\x20user\x20call','\x20is\x20live\x20now','2589788UTllag','live','sendGiftLiveCall','124pklGZt','text','updateMessageStatusLiveCall','updateMessageCurrentStatusUser','sendMessageLiveCall','512934XgVTZS','https','INSERT\x20INTO\x20payment\x20(type,\x20user_id,\x20transaction_type,\x20payment_type,\x20payment_mode,\x20coin,\x20gift_history_id,created_at)\x20VALUES\x20('];_0x115e=function(){return _0x1839dd;};return _0x115e();}function doDecrypt(_0x1851dc){var _0x5316b4=_0x29d80a,_0x3c15d1=config[_0x5316b4(0x297)],_0xd24254=crypto['AES'][_0x5316b4(0x254)](_0x1851dc,_0x3c15d1)[_0x5316b4(0x291)](crypto[_0x5316b4(0x266)][_0x5316b4(0x25c)]);return isJsonString(_0xd24254)&&(_0xd24254=JSON[_0x5316b4(0x233)](_0xd24254)),_0xd24254;}function isJsonString(_0x33d8e7){var _0x1e57ae=_0x29d80a;try{JSON[_0x1e57ae(0x233)](_0x33d8e7);}catch(_0x19b045){return![];}return!![];}function getDbData(_0x49a153){return new Promise((_0x526c09,_0x2f16fc)=>{var _0x38dd32=_0x5bff;db[_0x38dd32(0x250)](_0x49a153,function(_0x282304,_0x195354,_0x1e75ce){if(_0x282304)return _0x2f16fc(_0x282304);return _0x526c09(_0x195354);});});}function _0x5bff(_0x8d92db,_0x3b7b9c){var _0x115e5a=_0x115e();return _0x5bff=function(_0x5bff47,_0x4ae5dc){_0x5bff47=_0x5bff47-0x1ec;var _0x54ffd8=_0x115e5a[_0x5bff47];return _0x54ffd8;},_0x5bff(_0x8d92db,_0x3b7b9c);}async function endLiveCallIfExist(_0x208367,_0x22b4c5){var _0x598f7f=_0x29d80a;userId=_0x22b4c5[_0x598f7f(0x300)];var _0x151634=Math['round'](new Date()['getTime']()/0x3e8),_0x219163=_0x598f7f(0x208)+STATUS_LIVE_CALL_ONGOING+_0x598f7f(0x239)+userId,_0x2a8387=await getDbData(_0x219163);if(_0x2a8387[_0x598f7f(0x342)]){var _0x9b448f=_0x2a8387[0x0]['id'],_0x35749d=_0x2a8387[0x0][_0x598f7f(0x237)],_0x2999f0=_0x151634-_0x35749d,_0x1705b1='update\x20user_live_history\x20set\x20status='+STATUS_LIVE_CALL_COMPLETED+_0x598f7f(0x2d0)+db['escape'](_0x151634)+_0x598f7f(0x304)+db[_0x598f7f(0x2d9)](_0x2999f0)+_0x598f7f(0x284)+db[_0x598f7f(0x2d9)](_0x9b448f);getDbData(_0x1705b1);var _0x219163=_0x598f7f(0x2c1)+STATUS_LIVE_CALL_BATTLE_ONGOING+_0x598f7f(0x2d5)+userId,_0x576ce6=await getDbData(_0x219163);_0x576ce6[_0x598f7f(0x342)]&&_0x576ce6[_0x598f7f(0x2e0)](_0x25d849=>{var _0x2561b2=_0x598f7f,_0x4073c4=_0x25d849['id'],_0x55a6f4=_0x25d849['start_time'],_0x394cb2=_0x151634-_0x55a6f4,_0xb56932='update\x20user_live_battle\x20set\x20status='+STATUS_LIVE_CALL_BATTLE_COMPLETED+',\x20end_time\x20=\x20'+db[_0x2561b2(0x2d9)](_0x151634)+_0x2561b2(0x304)+db[_0x2561b2(0x2d9)](_0x394cb2)+_0x2561b2(0x284)+db[_0x2561b2(0x2d9)](_0x4073c4);getDbData(_0xb56932);}),_0x208367['to'](_0x9b448f)[_0x598f7f(0x234)](_0x598f7f(0x295),{'liveCallId':_0x9b448f,'userId':_0x208367[_0x598f7f(0x300)],'username':_0x208367[_0x598f7f(0x2ab)]}),io['in'](_0x9b448f)['socketsLeave'](_0x9b448f);}var _0x219163=_0x598f7f(0x2c1)+STATUS_LIVE_CALL_BATTLE_ONGOING+_0x598f7f(0x293)+userId,_0x576ce6=await getDbData(_0x219163);_0x576ce6[_0x598f7f(0x342)]&&_0x576ce6['forEach'](async _0x5cc79a=>{var _0x223fd2=_0x598f7f,_0x2dc370=_0x5cc79a['id'],_0x41dfdf=_0x5cc79a[_0x223fd2(0x2a8)],_0x34c057=_0x5cc79a['start_time'],_0x213750=_0x151634-_0x34c057,_0x5c4ed4='update\x20user_live_battle\x20set\x20status='+STATUS_LIVE_CALL_BATTLE_COMPLETED+_0x223fd2(0x2d0)+db[_0x223fd2(0x2d9)](_0x151634)+_0x223fd2(0x304)+db['escape'](_0x213750)+_0x223fd2(0x284)+db['escape'](_0x2dc370);getDbData(_0x5c4ed4);var _0x1e43f8={'liveCallId':_0x41dfdf,'battleId':_0x2dc370},_0x4baabb=await getLiveBattleInfo(_0x1e43f8);io['to'](_0x41dfdf)[_0x223fd2(0x234)](_0x223fd2(0x2a0),{'liveCallId':_0x41dfdf,'battleId':_0x2dc370,'battleInfo':_0x4baabb});});}async function getLiveBattleInfo(_0x2a88ad){var _0x357c36=_0x29d80a,_0x3df7f3=_0x2a88ad[_0x357c36(0x2a7)],_0x2de1e4={},_0x4ab673={},_0x2357fc=[],_0x4f7a1e=_0x357c36(0x2f6)+STATUS_LIVE_CALL_BATTLE_ONGOING+_0x357c36(0x20e)+_0x3df7f3,_0x85a0be=await getDbData(_0x4f7a1e);if(_0x85a0be[_0x357c36(0x342)]){var _0xf6ac3e=_0x85a0be[0x0];_0x4ab673=_0xf6ac3e;let _0x1b91a4=Math['round'](new Date()['getTime']()/0x3e8);var _0x4c2d9e=_0x1b91a4-_0x4ab673['start_time'];_0x4ab673['totalOngoingTime']=_0x4c2d9e,_0x4ab673[_0x357c36(0x2aa)]=_0x4ab673[_0x357c36(0x346)]-_0x4c2d9e;var _0x4f7a1e=_0x357c36(0x2e8)+_0xf6ac3e[_0x357c36(0x2df)],_0x113a3a=await getDbData(_0x4f7a1e);if(_0x113a3a[_0x357c36(0x342)]){var _0x6676ca=_0x113a3a[0x0],_0x4f7a1e='SELECT\x20sum(coin)\x20as\x20total_coin,\x20count(id)\x20as\x20total_gift\x20from\x20gift_history\x20where\x20gift_history.reciever_id\x20='+_0xf6ac3e[_0x357c36(0x2df)]+'\x20and\x20gift_history.battle_id\x20='+_0xf6ac3e['id'],_0x17df38=await getDbData(_0x4f7a1e),_0x4a9765=_0x17df38[0x0];_0x6676ca[_0x357c36(0x2a9)]==null&&(_0x6676ca[_0x357c36(0x2a9)]='default.png');var _0x4674fe=STORAGE_URL+_0x357c36(0x34b)+_0x6676ca[_0x357c36(0x2a9)];_0x6676ca[_0x357c36(0x2a9)]==null&&(_0x4674fe=null);var _0x256dc9=Math[_0x357c36(0x1f8)](_0x4a9765['total_coin']),_0x4a68b2={'userId':_0x6676ca['id'],'username':_0x6676ca[_0x357c36(0x2ab)],'userImageUrl':_0x4674fe,'liveCallId':_0x3df7f3,'battleId':_0xf6ac3e['id'],'isSuperHost':0x1,'totalCoin':_0x256dc9,'totalGift':_0x4a9765[_0x357c36(0x2e2)]};_0x2357fc[_0x357c36(0x334)](_0x4a68b2);}var _0x4f7a1e=_0x357c36(0x280)+_0xf6ac3e[_0x357c36(0x307)],_0x24a0df=await getDbData(_0x4f7a1e);if(_0x24a0df['length']){var _0x4f7a1e=_0x357c36(0x2ee)+_0xf6ac3e['host_user_id']+_0x357c36(0x30b)+_0xf6ac3e['id'],_0x17df38=await getDbData(_0x4f7a1e),_0x4a9765=_0x17df38[0x0],_0x256dc9=Math['floor'](_0x4a9765[_0x357c36(0x2b6)]),_0x55547b=_0x24a0df[0x0];_0x55547b[_0x357c36(0x2a9)]==null&&(_0x55547b['image']='default.png');var _0x4674fe=STORAGE_URL+_0x357c36(0x34b)+_0x55547b[_0x357c36(0x2a9)],_0x4a68b2={'userId':_0x55547b['id'],'username':_0x55547b[_0x357c36(0x2ab)],'userImageUrl':_0x4674fe,'liveCallId':_0x3df7f3,'battleId':_0xf6ac3e['id'],'isSuperHost':0x0,'totalCoin':_0x256dc9,'totalGift':_0x4a9765[_0x357c36(0x2e2)]};_0x2357fc[_0x357c36(0x334)](_0x4a68b2);}}return _0x2de1e4[_0x357c36(0x263)]=_0x4ab673,_0x2de1e4[_0x357c36(0x227)]=_0x2357fc,_0x2de1e4;}async function getBattleDetail(_0x2e0df0){var _0x29bee2=_0x29d80a,_0x56c2a2=_0x2e0df0[_0x29bee2(0x321)],_0x12244d=_0x2e0df0[_0x29bee2(0x2a7)],_0x5c3772={},_0x35341a={},_0x3c9647=[],_0x3b6c54='SELECT\x20\x20user_live_battle.id\x20,\x20user_live_battle.super_host_user_id\x20,\x20user_live_battle.host_user_id,start_time,end_time,total_time,total_allowed_time,status\x20from\x20user_live_battle\x20\x20where\x20\x20user_live_battle.id\x20='+_0x56c2a2,_0xcc660c=await getDbData(_0x3b6c54);if(_0xcc660c[_0x29bee2(0x342)]){var _0x43d199=_0xcc660c[0x0];_0x35341a=_0x43d199;var _0x53931e=0x0,_0x1c8b37=0x0;if(_0x43d199[_0x29bee2(0x33a)]==STATUS_LIVE_CALL_BATTLE_ONGOING){let _0x178102=Math['round'](new Date()['getTime']()/0x3e8);_0x53931e=_0x178102-_0x35341a[_0x29bee2(0x237)],_0x1c8b37=_0x35341a[_0x29bee2(0x346)]-_0x53931e;}else _0x43d199[_0x29bee2(0x33a)]==STATUS_LIVE_CALL_BATTLE_PENDING&&(_0x53931e=0x0,_0x1c8b37=_0x35341a[_0x29bee2(0x346)]);_0x35341a[_0x29bee2(0x230)]=_0x53931e,_0x35341a[_0x29bee2(0x2aa)]=_0x1c8b37;var _0x3b6c54=_0x29bee2(0x2e8)+_0x43d199['super_host_user_id'],_0x393dfe=await getDbData(_0x3b6c54);if(_0x393dfe['length']){var _0x5da452=_0x393dfe[0x0],_0x3b6c54='SELECT\x20sum(coin)\x20as\x20total_coin,\x20count(id)\x20as\x20total_gift\x20from\x20gift_history\x20where\x20gift_history.reciever_id\x20='+_0x43d199[_0x29bee2(0x2df)]+_0x29bee2(0x30b)+_0x43d199['id'],_0x4e0c9a=await getDbData(_0x3b6c54),_0x1c8824=_0x4e0c9a[0x0];_0x5da452[_0x29bee2(0x2a9)]==null&&(_0x5da452['image']=_0x29bee2(0x255));var _0x247df0=STORAGE_URL+_0x29bee2(0x34b)+_0x5da452[_0x29bee2(0x2a9)];_0x5da452[_0x29bee2(0x2a9)]==null&&(_0x247df0=null);var _0x107cb4={'userId':_0x5da452['id'],'username':_0x5da452['username'],'userImageUrl':_0x247df0,'liveCallId':_0x12244d,'battleId':_0x43d199['id'],'isSuperHost':0x1,'totalCoin':_0x1c8824[_0x29bee2(0x2b6)],'totalGift':_0x1c8824['total_gift']};_0x3c9647['push'](_0x107cb4);}var _0x3b6c54=_0x29bee2(0x2e8)+_0x43d199[_0x29bee2(0x307)],_0x1a8aa8=await getDbData(_0x3b6c54);if(_0x1a8aa8['length']){var _0x3b6c54=_0x29bee2(0x2ee)+_0x43d199[_0x29bee2(0x307)]+_0x29bee2(0x30b)+_0x43d199['id'],_0x4e0c9a=await getDbData(_0x3b6c54),_0x1c8824=_0x4e0c9a[0x0],_0x4aa1ef=_0x1a8aa8[0x0];_0x4aa1ef['image']==null&&(_0x4aa1ef[_0x29bee2(0x2a9)]='default.png');var _0x247df0=STORAGE_URL+_0x29bee2(0x34b)+_0x4aa1ef[_0x29bee2(0x2a9)];_0x4aa1ef[_0x29bee2(0x2a9)]==null&&(_0x247df0=null);var _0x107cb4={'userId':_0x4aa1ef['id'],'username':_0x4aa1ef['username'],'userImageUrl':_0x247df0,'liveCallId':_0x12244d,'battleId':_0x43d199['id'],'isSuperHost':0x0,'totalCoin':_0x1c8824[_0x29bee2(0x2b6)],'totalGift':_0x1c8824[_0x29bee2(0x2e2)]};_0x3c9647[_0x29bee2(0x334)](_0x107cb4);}}return _0x5c3772[_0x29bee2(0x263)]=_0x35341a,_0x5c3772['liveBattleHosts']=_0x3c9647,_0x5c3772;}server[_0x29d80a(0x314)](config[_0x29d80a(0x337)],()=>{var _0xe72564=_0x29d80a;console[_0xe72564(0x2a1)](_0xe72564(0x281)+config[_0xe72564(0x337)]);});